<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>clustering-code-R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="clustering-code-R_files/libs/clipboard/clipboard.min.js"></script>
<script src="clustering-code-R_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="clustering-code-R_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="clustering-code-R_files/libs/quarto-html/popper.min.js"></script>
<script src="clustering-code-R_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="clustering-code-R_files/libs/quarto-html/anchor.min.js"></script>
<link href="clustering-code-R_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="clustering-code-R_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="clustering-code-R_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="clustering-code-R_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="clustering-code-R_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="clustering-code-R_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="clustering-code-R_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="clustering-code-R_files/libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="clustering-code-R_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="clustering-code-R_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="clustering-code-R_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="clustering-code-R_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="clustering-code-R_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="clustering-code-R_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">clustering-code-R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="libraries" class="level1">
<h1>Libraries</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyclust)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="base-de-datos-customer-personality-analysis" class="level1">
<h1>Base de Datos: Customer Personality Analysis</h1>
<section id="contenido" class="level2">
<h2 class="anchored" data-anchor-id="contenido">Contenido</h2>
<p>Base de datos de <strong>perfiles de clientes</strong> con información demográfica, histórico de compras, interacciones con campañas de marketing y patrones de comportamiento.</p>
</section>
<section id="variables-originales" class="level2">
<h2 class="anchored" data-anchor-id="variables-originales">Variables originales</h2>
<ul>
<li>Datos demográficos (edad, educación, ingresos, estado civil)</li>
<li>Gasto por categoría de producto (vinos, frutas, carnes, pescado, dulces, oro)</li>
<li>Canales de compra (web, catálogo, tienda física)</li>
<li>Respuesta a campañas de marketing</li>
<li>Recencia de compras e interacciones</li>
</ul>
</section>
<section id="variables-seleccionadas-para-la-práctica" class="level2">
<h2 class="anchored" data-anchor-id="variables-seleccionadas-para-la-práctica">Variables seleccionadas para la práctica</h2>
<ul>
<li><strong>Gasto total:</strong> Suma de todas las categorías de productos</li>
<li><strong>Cantidad de compra total:</strong> Suma de todas las transacciones</li>
<li><strong>Edad:</strong> Derivada del año de nacimiento</li>
</ul>
</section>
</section>
<section id="importacion-y-tratamiento-de-la-data" class="level1">
<h1>Importacion y tratamiento de la data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"marketing_campaign.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2240 obs. of  29 variables:
 $ ID                 : int  5524 2174 4141 6182 5324 7446 965 6177 4855 5899 ...
 $ Year_Birth         : int  1957 1954 1965 1984 1981 1967 1971 1985 1974 1950 ...
 $ Education          : chr  "Graduation" "Graduation" "Graduation" "Graduation" ...
 $ Marital_Status     : chr  "Single" "Single" "Together" "Together" ...
 $ Income             : int  58138 46344 71613 26646 58293 62513 55635 33454 30351 5648 ...
 $ Kidhome            : int  0 1 0 1 1 0 0 1 1 1 ...
 $ Teenhome           : int  0 1 0 0 0 1 1 0 0 1 ...
 $ Dt_Customer        : chr  "04-09-2012" "08-03-2014" "21-08-2013" "10-02-2014" ...
 $ Recency            : int  58 38 26 26 94 16 34 32 19 68 ...
 $ MntWines           : int  635 11 426 11 173 520 235 76 14 28 ...
 $ MntFruits          : int  88 1 49 4 43 42 65 10 0 0 ...
 $ MntMeatProducts    : int  546 6 127 20 118 98 164 56 24 6 ...
 $ MntFishProducts    : int  172 2 111 10 46 0 50 3 3 1 ...
 $ MntSweetProducts   : int  88 1 21 3 27 42 49 1 3 1 ...
 $ MntGoldProds       : int  88 6 42 5 15 14 27 23 2 13 ...
 $ NumDealsPurchases  : int  3 2 1 2 5 2 4 2 1 1 ...
 $ NumWebPurchases    : int  8 1 8 2 5 6 7 4 3 1 ...
 $ NumCatalogPurchases: int  10 1 2 0 3 4 3 0 0 0 ...
 $ NumStorePurchases  : int  4 2 10 4 6 10 7 4 2 0 ...
 $ NumWebVisitsMonth  : int  7 5 4 6 5 6 6 8 9 20 ...
 $ AcceptedCmp3       : int  0 0 0 0 0 0 0 0 0 1 ...
 $ AcceptedCmp4       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AcceptedCmp5       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AcceptedCmp1       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AcceptedCmp2       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Complain           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Z_CostContact      : int  3 3 3 3 3 3 3 3 3 3 ...
 $ Z_Revenue          : int  11 11 11 11 11 11 11 11 11 11 ...
 $ Response           : int  1 0 0 0 0 0 0 0 1 0 ...</code></pre>
</div>
</div>
<p>Exploramos las variables categoricas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Education <span class="sc">|&gt;</span> <span class="fu">n_distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Marital_Status <span class="sc">|&gt;</span>  <span class="fu">n_distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Dt_Customer <span class="sc">|&gt;</span> <span class="fu">n_distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 663</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Education <span class="sc">|&gt;</span> <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  2n Cycle      Basic Graduation     Master        PhD 
       203         54       1127        370        486 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Marital_Status <span class="sc">|&gt;</span> <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Absurd    Alone Divorced  Married   Single Together    Widow     YOLO 
       2        3      232      864      480      580       77        2 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Dt_Customer <span class="sc">|&gt;</span> <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
01-01-2013 01-01-2014 01-02-2013 01-02-2014 01-03-2013 01-03-2014 01-04-2013 
         4          3          3          1          3          9          5 
01-04-2014 01-05-2013 01-05-2014 01-06-2013 01-07-2013 01-08-2012 01-08-2013 
         3          3          2          2          3          4          5 
01-09-2012 01-09-2013 01-10-2012 01-10-2013 01-11-2012 01-11-2013 01-12-2012 
         1          3          5          3          2          1          4 
01-12-2013 02-01-2013 02-01-2014 02-02-2013 02-02-2014 02-03-2013 02-03-2014 
         5          9          3          4          5          1          4 
02-04-2013 02-04-2014 02-05-2013 02-05-2014 02-06-2013 02-06-2014 02-07-2013 
         2          1          5          7          2          2          3 
02-08-2012 02-08-2013 02-09-2012 02-09-2013 02-10-2012 02-10-2013 02-11-2012 
         3          4          1          2          1          7          2 
02-11-2013 02-12-2012 02-12-2013 03-01-2013 03-01-2014 03-02-2013 03-02-2014 
         5          2          3          1          3          2          1 
03-03-2013 03-03-2014 03-04-2013 03-04-2014 03-05-2013 03-05-2014 03-06-2013 
         6          3          3          3          3          2          8 
03-06-2014 03-07-2013 03-08-2012 03-08-2013 03-09-2012 03-10-2013 03-11-2012 
         2          5          5          2          4          5          8 
03-11-2013 03-12-2012 03-12-2013 04-01-2013 04-01-2014 04-02-2013 04-02-2014 
         4          4          1          2          2          2          1 
04-03-2013 04-03-2014 04-04-2014 04-05-2013 04-05-2014 04-06-2013 04-06-2014 
         4          3          2          3          4          7          1 
04-07-2013 04-08-2012 04-08-2013 04-09-2012 04-09-2013 04-10-2012 04-10-2013 
         6          4          1          4          2          6          7 
04-11-2012 04-11-2013 04-12-2012 04-12-2013 05-01-2013 05-01-2014 05-02-2014 
         1          3          2          4          4          2          3 
05-03-2013 05-03-2014 05-04-2013 05-04-2014 05-05-2013 05-05-2014 05-06-2014 
         1          3          8          9          3          1          3 
05-07-2013 05-08-2012 05-08-2013 05-09-2012 05-09-2013 05-10-2012 05-10-2013 
         5          1          4          1          4          6          2 
05-11-2012 05-11-2013 05-12-2012 05-12-2013 06-01-2013 06-01-2014 06-02-2013 
         5          4          4          2          2          1          5 
06-02-2014 06-03-2013 06-03-2014 06-04-2013 06-04-2014 06-05-2013 06-05-2014 
         2          2          2          2          3          5          2 
06-06-2013 06-06-2014 06-07-2013 06-08-2012 06-08-2013 06-09-2012 06-09-2013 
         3          1          4          3          3          4          3 
06-10-2012 06-10-2013 06-11-2012 06-11-2013 06-12-2012 06-12-2013 07-01-2013 
         2          4          2          5          3          2          2 
07-01-2014 07-02-2013 07-02-2014 07-03-2013 07-03-2014 07-04-2013 07-04-2014 
         3          2          7          4          2          1          4 
07-05-2013 07-05-2014 07-06-2014 07-07-2013 07-08-2012 07-08-2013 07-09-2012 
         3          5          3          3          4          7          6 
07-09-2013 07-10-2012 07-11-2012 07-11-2013 07-12-2012 07-12-2013 08-01-2013 
         3          1          5          8          5          5          5 
08-02-2013 08-02-2014 08-03-2013 08-03-2014 08-04-2013 08-04-2014 08-05-2013 
         2          1          3          5          4          2          4 
08-05-2014 08-06-2013 08-06-2014 08-07-2013 08-08-2012 08-08-2013 08-09-2012 
         4          5          4          4          7          2          6 
08-10-2013 08-11-2012 08-11-2013 08-12-2012 08-12-2013 09-01-2013 09-01-2014 
         6          3          1          1          2          2          1 
09-02-2013 09-02-2014 09-03-2013 09-03-2014 09-04-2013 09-04-2014 09-05-2013 
         2          3          1          2          1          2          3 
09-05-2014 09-06-2013 09-06-2014 09-07-2013 09-08-2012 09-08-2013 09-09-2012 
         1          1          3          3          2          4          3 
09-09-2013 09-10-2012 09-10-2013 09-11-2012 09-11-2013 09-12-2012 09-12-2013 
         5          1          3          8          1          2          5 
10-01-2013 10-01-2014 10-02-2013 10-02-2014 10-03-2013 10-03-2014 10-04-2013 
         7          4          3          5          5          5          3 
10-04-2014 10-05-2013 10-05-2014 10-06-2013 10-06-2014 10-08-2012 10-08-2013 
         1          4          4          4          3          2          1 
10-09-2012 10-09-2013 10-10-2012 10-10-2013 10-11-2012 10-11-2013 10-12-2012 
         4          4          5          2          6          3          2 
10-12-2013 11-01-2013 11-01-2014 11-02-2013 11-02-2014 11-03-2013 11-03-2014 
         2          5          5          4          3          4          2 
11-04-2013 11-04-2014 11-05-2013 11-05-2014 11-06-2013 11-06-2014 11-07-2013 
         3          4          8          8          2          1          3 
11-08-2012 11-08-2013 11-09-2012 11-09-2013 11-10-2012 11-10-2013 11-11-2012 
         3          4          3          6          1          4          3 
11-12-2012 11-12-2013 12-01-2013 12-01-2014 12-02-2013 12-02-2014 12-03-2013 
         3          4          8          2          5          3          5 
12-03-2014 12-04-2013 12-04-2014 12-05-2013 12-05-2014 12-06-2013 12-06-2014 
         5          1          2          4         11          3          1 
12-07-2013 12-08-2012 12-08-2013 12-09-2012 12-09-2013 12-10-2012 12-10-2013 
         4          6          1         11          6          5          6 
12-11-2012 12-11-2013 12-12-2012 12-12-2013 13-01-2013 13-01-2014 13-02-2013 
         3          2          6          3          6          1          7 
13-02-2014 13-03-2014 13-04-2013 13-04-2014 13-05-2013 13-05-2014 13-06-2013 
         4          1          7          6          1          3          5 
13-06-2014 13-07-2013 13-08-2012 13-08-2013 13-09-2013 13-10-2012 13-10-2013 
         1          3          2          1          1          6          3 
13-11-2012 13-11-2013 13-12-2013 14-01-2013 14-01-2014 14-02-2013 14-02-2014 
         6          3          2          1          2         11          1 
14-03-2013 14-04-2013 14-04-2014 14-05-2013 14-06-2013 14-06-2014 14-07-2013 
         2          1          2          1          3          1          4 
14-08-2012 14-08-2013 14-09-2012 14-09-2013 14-10-2012 14-10-2013 14-11-2012 
         2          1          6          1          5          4          1 
14-11-2013 14-12-2012 14-12-2013 15-01-2013 15-01-2014 15-02-2013 15-02-2014 
         6          1          2          2          4          3          5 
15-03-2013 15-04-2013 15-04-2014 15-05-2013 15-05-2014 15-06-2014 15-07-2013 
         2          4          1          4          1          4          2 
15-08-2012 15-08-2013 15-09-2012 15-09-2013 15-10-2012 15-10-2013 15-11-2013 
         1          5          2          4          4          2          6 
15-12-2012 15-12-2013 16-01-2013 16-02-2013 16-02-2014 16-03-2013 16-03-2014 
         2          2          7          7          4          2          2 
16-04-2013 16-04-2014 16-05-2013 16-05-2014 16-06-2013 16-06-2014 16-07-2013 
         2          4          1          2          2          4          3 
16-08-2012 16-08-2013 16-09-2013 16-10-2012 16-10-2013 16-11-2012 16-12-2012 
         3          3          5          4          6          2          4 
16-12-2013 17-01-2013 17-01-2014 17-02-2013 17-02-2014 17-03-2013 17-03-2014 
         4          6          4          3          5          5          7 
17-04-2013 17-04-2014 17-05-2013 17-05-2014 17-06-2013 17-06-2014 17-07-2013 
         2          2          6          2          4          3          2 
17-08-2012 17-08-2013 17-09-2012 17-09-2013 17-10-2012 17-10-2013 17-11-2012 
         8          4          3          5          2          4          5 
17-11-2013 17-12-2012 17-12-2013 18-01-2014 18-02-2013 18-02-2014 18-03-2013 
         4          1          4          3          5          3          5 
18-03-2014 18-04-2013 18-04-2014 18-05-2013 18-05-2014 18-06-2013 18-06-2014 
         5          6          5          3          5          2          3 
18-07-2013 18-08-2012 18-08-2013 18-09-2012 18-09-2013 18-10-2012 18-10-2013 
         3          5          1          6          5          5          3 
18-11-2012 18-11-2013 18-12-2012 18-12-2013 19-01-2013 19-01-2014 19-02-2013 
         1          1          2          1          4          3          5 
19-02-2014 19-03-2013 19-03-2014 19-04-2013 19-04-2014 19-05-2013 19-05-2014 
         2          5          3          1          2          2          5 
19-06-2013 19-06-2014 19-07-2013 19-08-2012 19-08-2013 19-09-2012 19-09-2013 
         4          4          5          2          3          1          3 
19-10-2012 19-10-2013 19-11-2012 19-11-2013 19-12-2012 19-12-2013 20-01-2013 
         1          2          3          3          4          2          5 
20-02-2013 20-03-2013 20-03-2014 20-04-2013 20-04-2014 20-05-2013 20-06-2013 
         7          3          4          3          4          6          5 
20-06-2014 20-07-2013 20-08-2012 20-08-2013 20-09-2012 20-09-2013 20-10-2012 
         2          1          3         10          2          3          2 
20-10-2013 20-11-2012 20-11-2013 20-12-2012 20-12-2013 21-01-2013 21-01-2014 
         4          2          3          1          3          3          5 
21-02-2013 21-03-2013 21-03-2014 21-04-2013 21-04-2014 21-05-2013 21-06-2013 
         2          2          3          5          4          2          4 
21-06-2014 21-07-2013 21-08-2012 21-08-2013 21-09-2012 21-09-2013 21-10-2012 
         2          5          2          4          4          1          1 
21-10-2013 21-11-2012 21-11-2013 21-12-2012 21-12-2013 22-01-2013 22-01-2014 
         6          2          2          1          2          2          5 
22-02-2013 22-02-2014 22-03-2013 22-03-2014 22-04-2013 22-04-2014 22-05-2013 
         4          1          3          1          6          1          7 
22-05-2014 22-06-2013 22-06-2014 22-07-2013 22-08-2012 22-08-2013 22-09-2012 
        10          3          5          2          8          3          6 
22-09-2013 22-10-2012 22-10-2013 22-11-2012 22-11-2013 22-12-2012 22-12-2013 
         4          3          3          3          3          5          1 
23-01-2013 23-01-2014 23-02-2013 23-02-2014 23-03-2013 23-03-2014 23-04-2013 
         5          5          2          2          3          9          3 
23-04-2014 23-05-2013 23-05-2014 23-06-2013 23-06-2014 23-07-2013 23-08-2012 
         5          3          8          4          2          3          1 
23-08-2013 23-09-2012 23-09-2013 23-10-2012 23-10-2013 23-11-2012 23-11-2013 
         4          3          2          2          2          8          7 
23-12-2012 23-12-2013 24-01-2013 24-01-2014 24-02-2014 24-03-2013 24-03-2014 
         2          4          1          3          5          3          4 
24-04-2013 24-04-2014 24-05-2013 24-05-2014 24-06-2013 24-06-2014 24-07-2013 
         2          6          1          5          3          2          2 
24-08-2012 24-08-2013 24-09-2012 24-09-2013 24-10-2012 24-10-2013 24-11-2012 
         2          1          2          2          1          4          3 
24-12-2012 24-12-2013 25-01-2013 25-01-2014 25-02-2013 25-02-2014 25-03-2013 
         5          3          4          5          3          5          1 
25-03-2014 25-04-2013 25-04-2014 25-05-2013 25-05-2014 25-06-2013 25-06-2014 
         3          2          2          1          3          2          5 
25-07-2013 25-08-2012 25-08-2013 25-09-2012 25-09-2013 25-10-2012 25-10-2013 
         3          3          3          4          3          2          7 
25-11-2012 25-11-2013 25-12-2012 25-12-2013 26-01-2013 26-01-2014 26-02-2013 
         2          3          3          4          3          7          2 
26-02-2014 26-03-2013 26-03-2014 26-04-2014 26-05-2013 26-05-2014 26-06-2013 
         2          4          2          1          4          3          1 
26-06-2014 26-07-2013 26-08-2012 26-08-2013 26-09-2012 26-09-2013 26-10-2012 
         4          2          3          3          3          3          3 
26-10-2013 26-11-2012 26-11-2013 26-12-2012 26-12-2013 27-01-2013 27-01-2014 
         1          2          3          1          4          2          4 
27-02-2013 27-02-2014 27-03-2013 27-03-2014 27-04-2013 27-04-2014 27-05-2013 
         3          2          4          1          5          1          1 
27-05-2014 27-06-2013 27-06-2014 27-07-2013 27-08-2012 27-08-2013 27-09-2012 
         1          4          3          3          3          1          2 
27-09-2013 27-10-2012 27-10-2013 27-11-2012 27-11-2013 27-12-2012 27-12-2013 
         3          2          3          1          2          1          4 
28-01-2014 28-02-2013 28-02-2014 28-03-2013 28-03-2014 28-04-2013 28-04-2014 
         4          2          2          5          1          2          4 
28-05-2013 28-05-2014 28-06-2013 28-06-2014 28-07-2013 28-08-2012 28-08-2013 
         4          4          3          3          1          2          5 
28-09-2012 28-09-2013 28-10-2012 28-10-2013 28-11-2012 28-11-2013 28-12-2012 
         4          6          4          8          3          2          4 
28-12-2013 29-01-2013 29-01-2014 29-03-2013 29-03-2014 29-04-2013 29-04-2014 
         1          3          1          5          6          3          4 
29-05-2013 29-05-2014 29-06-2013 29-06-2014 29-07-2013 29-08-2012 29-08-2013 
         4          6          3          2          5          8          3 
29-09-2012 29-10-2012 29-10-2013 29-11-2012 29-11-2013 29-12-2012 29-12-2013 
         2          9          3          4          4          2          5 
30-01-2014 30-03-2013 30-03-2014 30-04-2013 30-04-2014 30-05-2013 30-05-2014 
         4          4          7          1          4          2          1 
30-06-2013 30-07-2012 30-07-2013 30-08-2012 30-08-2013 30-09-2012 30-09-2013 
         3          1          5          4          3          1          5 
30-10-2012 30-10-2013 30-11-2012 30-11-2013 30-12-2012 30-12-2013 31-01-2013 
         1          3          1          1          5          3          2 
31-01-2014 31-03-2013 31-03-2014 31-05-2013 31-05-2014 31-07-2012 31-07-2013 
         1          5          5          3          2          1          2 
31-08-2012 31-08-2013 31-10-2012 31-12-2012 31-12-2013 
        12          8          5          1          3 </code></pre>
</div>
</div>
<p>Transformamos las variables</p>
<ul>
<li>Calculamos la edad</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Edad =</span> <span class="dv">2021</span> <span class="sc">-</span> Year_Birth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Gasto total</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gasto_total =</span> MntWines <span class="sc">+</span> MntFruits <span class="sc">+</span> MntMeatProducts <span class="sc">+</span> MntFishProducts <span class="sc">+</span> MntSweetProducts <span class="sc">+</span> MntGoldProds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Estado civil</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estado_civil =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    Marital_Status <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Married"</span>, <span class="st">"Together"</span>) <span class="sc">~</span> <span class="st">"Casado"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    Marital_Status <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Absurd"</span>, <span class="st">"Widow"</span>, <span class="st">"YOLO"</span>, <span class="st">"Divorced"</span>, <span class="st">"Single"</span>) <span class="sc">~</span> <span class="st">"Soltero"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Marital_Status</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Cantidad de hijos</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cantidad_hijos =</span> Kidhome <span class="sc">+</span> Teenhome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Tamaño de la familia</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Tamaño<span class="at">_Familia =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    estado_civil <span class="sc">==</span> <span class="st">"Soltero"</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Cantidad_hijos,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    estado_civil <span class="sc">==</span> <span class="st">"Casado"</span> <span class="sc">~</span> <span class="dv">2</span> <span class="sc">+</span> Cantidad_hijos</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Padre de familia</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Padre_de_Familia =</span> <span class="fu">ifelse</span>(Cantidad_hijos <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Educacion</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Educacion =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    Education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Basic"</span>, <span class="st">"2n Cycle"</span>) <span class="sc">~</span> <span class="st">"básica"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    Education <span class="sc">==</span> <span class="st">"Graduation"</span> <span class="sc">~</span> <span class="st">"Pre_grado"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    Education <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Master"</span>, <span class="st">"PhD"</span>) <span class="sc">~</span> <span class="st">"Pos_grado"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Education</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Cambio de nombre a columnas de interes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Vinos =</span> MntWines,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frutas =</span> MntFruits,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Carne =</span> MntMeatProducts,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pescado =</span> MntFishProducts,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dulces =</span> MntSweetProducts,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gold =</span> MntGoldProds,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ingreso =</span> Income,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    Niño<span class="at">_en_casa =</span> Kidhome,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adolecente_en_casa =</span> Teenhome,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dias_ultima_compra =</span> Recency,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">gasto_vinos =</span> MntWines,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">gasto_frutas =</span> MntFruits,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">gasto_carne =</span> MntMeatProducts,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">gasto_pescado =</span> MntFishProducts,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">gasto_dulces =</span> MntSweetProducts,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">gasto_gold =</span> MntGoldProds,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">cantidad_compra_con_descuento =</span> NumDealsPurchases,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cantidad_compra_web =</span> NumWebPurchases,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">cantidad_compra_catalogo =</span> NumCatalogPurchases,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">cantidad_compra_tienda =</span> NumStorePurchases, </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">cantidad_visitas_web_mes =</span> NumWebVisitsMonth, </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    acepto_campaña<span class="at">_1 =</span> AcceptedCmp1,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    acepto_campaña<span class="at">_2 =</span> AcceptedCmp2,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    acepto_campaña<span class="at">_3 =</span> AcceptedCmp3,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    acepto_campaña<span class="at">_4 =</span> AcceptedCmp4,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    acepto_campaña<span class="at">_5 =</span> AcceptedCmp5,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">registra_quejas =</span> Complain,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    respondio_a_campaña <span class="ot">=</span> Response</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Variables descartadas</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Marital_Status, Dt_Customer, Z_CostContact, Z_Revenue, Year_Birth, ID, Education))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Ingreso Niño_en_casa Adolecente_en_casa Dias_ultima_compra gasto_vinos
1   58138            0                  0                 58         635
2   46344            1                  1                 38          11
3   71613            0                  0                 26         426
4   26646            1                  0                 26          11
5   58293            1                  0                 94         173
6   62513            0                  1                 16         520
  gasto_frutas gasto_carne gasto_pescado gasto_dulces gasto_gold
1           88         546           172           88         88
2            1           6             2            1          6
3           49         127           111           21         42
4            4          20            10            3          5
5           43         118            46           27         15
6           42          98             0           42         14
  cantidad_compra_con_descuento cantidad_compra_web cantidad_compra_catalogo
1                             3                   8                       10
2                             2                   1                        1
3                             1                   8                        2
4                             2                   2                        0
5                             5                   5                        3
6                             2                   6                        4
  cantidad_compra_tienda cantidad_visitas_web_mes acepto_campaña_3
1                      4                        7                0
2                      2                        5                0
3                     10                        4                0
4                      4                        6                0
5                      6                        5                0
6                     10                        6                0
  acepto_campaña_4 acepto_campaña_5 acepto_campaña_1 acepto_campaña_2
1                0                0                0                0
2                0                0                0                0
3                0                0                0                0
4                0                0                0                0
5                0                0                0                0
6                0                0                0                0
  registra_quejas respondio_a_campaña Edad Gasto_total estado_civil
1               0                   1   64        1617      Soltero
2               0                   0   67          27      Soltero
3               0                   0   56         776       Casado
4               0                   0   37          53       Casado
5               0                   0   40         422       Casado
6               0                   0   54         716       Casado
  Cantidad_hijos Tamaño_Familia Padre_de_Familia Educacion
1              0              1                0 Pre_grado
2              2              3                1 Pre_grado
3              0              2                0 Pre_grado
4              1              3                1 Pre_grado
5              1              3                1 Pos_grado
6              1              3                1 Pos_grado</code></pre>
</div>
</div>
<section id="buscamos-valores-faltantes-y-duplicados" class="level2">
<h2 class="anchored" data-anchor-id="buscamos-valores-faltantes-y-duplicados">Buscamos valores faltantes y duplicados</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>na_dup <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  missing_values <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(data))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  missing_values_perc <span class="ot">&lt;-</span> missing_values <span class="sc">/</span> <span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  duplicated_values <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">duplicated</span>(data))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  duplicated_values_perc <span class="ot">&lt;-</span> duplicated_values <span class="sc">/</span> <span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  data_types <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data, class)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  resumen <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Valores_Faltantes  =</span> missing_values,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Valores_Faltantes_Porcentaje =</span> missing_values_perc,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Valores_Duplicados =</span> duplicated_values,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Valores_Duplicados_Porcentaje =</span> duplicated_values_perc,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tipo_de_Variable =</span> data_types,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(resumen)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="fu">na_dup</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              Valores_Faltantes Valores_Faltantes_Porcentaje
Ingreso                                      24                    1.0714286
Niño_en_casa                                  0                    0.0000000
Adolecente_en_casa                            0                    0.0000000
Dias_ultima_compra                            0                    0.0000000
gasto_vinos                                   0                    0.0000000
gasto_frutas                                  0                    0.0000000
gasto_carne                                   0                    0.0000000
gasto_pescado                                 0                    0.0000000
gasto_dulces                                  0                    0.0000000
gasto_gold                                    0                    0.0000000
cantidad_compra_con_descuento                 0                    0.0000000
cantidad_compra_web                           0                    0.0000000
cantidad_compra_catalogo                      0                    0.0000000
cantidad_compra_tienda                        0                    0.0000000
cantidad_visitas_web_mes                      0                    0.0000000
acepto_campaña_3                              0                    0.0000000
acepto_campaña_4                              0                    0.0000000
acepto_campaña_5                              0                    0.0000000
acepto_campaña_1                              0                    0.0000000
acepto_campaña_2                              0                    0.0000000
registra_quejas                               0                    0.0000000
respondio_a_campaña                           0                    0.0000000
Edad                                          0                    0.0000000
Gasto_total                                   0                    0.0000000
estado_civil                                  0                    0.0000000
Cantidad_hijos                                0                    0.0000000
Tamaño_Familia                                3                    0.1339286
Padre_de_Familia                              0                    0.0000000
Educacion                                     0                    0.0000000
                              Valores_Duplicados Valores_Duplicados_Porcentaje
Ingreso                                      183                      8.169643
Niño_en_casa                                 183                      8.169643
Adolecente_en_casa                           183                      8.169643
Dias_ultima_compra                           183                      8.169643
gasto_vinos                                  183                      8.169643
gasto_frutas                                 183                      8.169643
gasto_carne                                  183                      8.169643
gasto_pescado                                183                      8.169643
gasto_dulces                                 183                      8.169643
gasto_gold                                   183                      8.169643
cantidad_compra_con_descuento                183                      8.169643
cantidad_compra_web                          183                      8.169643
cantidad_compra_catalogo                     183                      8.169643
cantidad_compra_tienda                       183                      8.169643
cantidad_visitas_web_mes                     183                      8.169643
acepto_campaña_3                             183                      8.169643
acepto_campaña_4                             183                      8.169643
acepto_campaña_5                             183                      8.169643
acepto_campaña_1                             183                      8.169643
acepto_campaña_2                             183                      8.169643
registra_quejas                              183                      8.169643
respondio_a_campaña                          183                      8.169643
Edad                                         183                      8.169643
Gasto_total                                  183                      8.169643
estado_civil                                 183                      8.169643
Cantidad_hijos                               183                      8.169643
Tamaño_Familia                               183                      8.169643
Padre_de_Familia                             183                      8.169643
Educacion                                    183                      8.169643
                              Tipo_de_Variable
Ingreso                                integer
Niño_en_casa                           integer
Adolecente_en_casa                     integer
Dias_ultima_compra                     integer
gasto_vinos                            integer
gasto_frutas                           integer
gasto_carne                            integer
gasto_pescado                          integer
gasto_dulces                           integer
gasto_gold                             integer
cantidad_compra_con_descuento          integer
cantidad_compra_web                    integer
cantidad_compra_catalogo               integer
cantidad_compra_tienda                 integer
cantidad_visitas_web_mes               integer
acepto_campaña_3                       integer
acepto_campaña_4                       integer
acepto_campaña_5                       integer
acepto_campaña_1                       integer
acepto_campaña_2                       integer
registra_quejas                        integer
respondio_a_campaña                    integer
Edad                                   numeric
Gasto_total                            integer
estado_civil                         character
Cantidad_hijos                         integer
Tamaño_Familia                         numeric
Padre_de_Familia                       numeric
Educacion                            character</code></pre>
</div>
</div>
<ul>
<li>No se identificaron valores duplicados</li>
<li>Se identificó que la columna <strong>Ingreso</strong> tiene valores faltantes, por lo cual se procesera a la imputacion de los datos</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Ingreso =</span> <span class="fu">replace</span>(Ingreso, <span class="fu">is.na</span>(Ingreso), <span class="fu">mean</span>(Ingreso, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Verificamos que no haya datos faltantes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">na_dup</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              Valores_Faltantes Valores_Faltantes_Porcentaje
Ingreso                                       0                    0.0000000
Niño_en_casa                                  0                    0.0000000
Adolecente_en_casa                            0                    0.0000000
Dias_ultima_compra                            0                    0.0000000
gasto_vinos                                   0                    0.0000000
gasto_frutas                                  0                    0.0000000
gasto_carne                                   0                    0.0000000
gasto_pescado                                 0                    0.0000000
gasto_dulces                                  0                    0.0000000
gasto_gold                                    0                    0.0000000
cantidad_compra_con_descuento                 0                    0.0000000
cantidad_compra_web                           0                    0.0000000
cantidad_compra_catalogo                      0                    0.0000000
cantidad_compra_tienda                        0                    0.0000000
cantidad_visitas_web_mes                      0                    0.0000000
acepto_campaña_3                              0                    0.0000000
acepto_campaña_4                              0                    0.0000000
acepto_campaña_5                              0                    0.0000000
acepto_campaña_1                              0                    0.0000000
acepto_campaña_2                              0                    0.0000000
registra_quejas                               0                    0.0000000
respondio_a_campaña                           0                    0.0000000
Edad                                          0                    0.0000000
Gasto_total                                   0                    0.0000000
estado_civil                                  0                    0.0000000
Cantidad_hijos                                0                    0.0000000
Tamaño_Familia                                3                    0.1339286
Padre_de_Familia                              0                    0.0000000
Educacion                                     0                    0.0000000
                              Valores_Duplicados Valores_Duplicados_Porcentaje
Ingreso                                      183                      8.169643
Niño_en_casa                                 183                      8.169643
Adolecente_en_casa                           183                      8.169643
Dias_ultima_compra                           183                      8.169643
gasto_vinos                                  183                      8.169643
gasto_frutas                                 183                      8.169643
gasto_carne                                  183                      8.169643
gasto_pescado                                183                      8.169643
gasto_dulces                                 183                      8.169643
gasto_gold                                   183                      8.169643
cantidad_compra_con_descuento                183                      8.169643
cantidad_compra_web                          183                      8.169643
cantidad_compra_catalogo                     183                      8.169643
cantidad_compra_tienda                       183                      8.169643
cantidad_visitas_web_mes                     183                      8.169643
acepto_campaña_3                             183                      8.169643
acepto_campaña_4                             183                      8.169643
acepto_campaña_5                             183                      8.169643
acepto_campaña_1                             183                      8.169643
acepto_campaña_2                             183                      8.169643
registra_quejas                              183                      8.169643
respondio_a_campaña                          183                      8.169643
Edad                                         183                      8.169643
Gasto_total                                  183                      8.169643
estado_civil                                 183                      8.169643
Cantidad_hijos                               183                      8.169643
Tamaño_Familia                               183                      8.169643
Padre_de_Familia                             183                      8.169643
Educacion                                    183                      8.169643
                              Tipo_de_Variable
Ingreso                                numeric
Niño_en_casa                           integer
Adolecente_en_casa                     integer
Dias_ultima_compra                     integer
gasto_vinos                            integer
gasto_frutas                           integer
gasto_carne                            integer
gasto_pescado                          integer
gasto_dulces                           integer
gasto_gold                             integer
cantidad_compra_con_descuento          integer
cantidad_compra_web                    integer
cantidad_compra_catalogo               integer
cantidad_compra_tienda                 integer
cantidad_visitas_web_mes               integer
acepto_campaña_3                       integer
acepto_campaña_4                       integer
acepto_campaña_5                       integer
acepto_campaña_1                       integer
acepto_campaña_2                       integer
registra_quejas                        integer
respondio_a_campaña                    integer
Edad                                   numeric
Gasto_total                            integer
estado_civil                         character
Cantidad_hijos                         integer
Tamaño_Familia                         numeric
Padre_de_Familia                       numeric
Educacion                            character</code></pre>
</div>
</div>
<ul>
<li>Los valores faltantes fueron imputados correctamente</li>
</ul>
</section>
<section id="convertimos-a-factores" class="level2">
<h2 class="anchored" data-anchor-id="convertimos-a-factores">convertimos a factores</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>char_a_factores <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.factor))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">char_a_factores</span>(data)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2240 obs. of  29 variables:
 $ Ingreso                      : num  58138 46344 71613 26646 58293 ...
 $ Niño_en_casa                 : int  0 1 0 1 1 0 0 1 1 1 ...
 $ Adolecente_en_casa           : int  0 1 0 0 0 1 1 0 0 1 ...
 $ Dias_ultima_compra           : int  58 38 26 26 94 16 34 32 19 68 ...
 $ gasto_vinos                  : int  635 11 426 11 173 520 235 76 14 28 ...
 $ gasto_frutas                 : int  88 1 49 4 43 42 65 10 0 0 ...
 $ gasto_carne                  : int  546 6 127 20 118 98 164 56 24 6 ...
 $ gasto_pescado                : int  172 2 111 10 46 0 50 3 3 1 ...
 $ gasto_dulces                 : int  88 1 21 3 27 42 49 1 3 1 ...
 $ gasto_gold                   : int  88 6 42 5 15 14 27 23 2 13 ...
 $ cantidad_compra_con_descuento: int  3 2 1 2 5 2 4 2 1 1 ...
 $ cantidad_compra_web          : int  8 1 8 2 5 6 7 4 3 1 ...
 $ cantidad_compra_catalogo     : int  10 1 2 0 3 4 3 0 0 0 ...
 $ cantidad_compra_tienda       : int  4 2 10 4 6 10 7 4 2 0 ...
 $ cantidad_visitas_web_mes     : int  7 5 4 6 5 6 6 8 9 20 ...
 $ acepto_campaña_3             : int  0 0 0 0 0 0 0 0 0 1 ...
 $ acepto_campaña_4             : int  0 0 0 0 0 0 0 0 0 0 ...
 $ acepto_campaña_5             : int  0 0 0 0 0 0 0 0 0 0 ...
 $ acepto_campaña_1             : int  0 0 0 0 0 0 0 0 0 0 ...
 $ acepto_campaña_2             : int  0 0 0 0 0 0 0 0 0 0 ...
 $ registra_quejas              : int  0 0 0 0 0 0 0 0 0 0 ...
 $ respondio_a_campaña          : int  1 0 0 0 0 0 0 0 1 0 ...
 $ Edad                         : num  64 67 56 37 40 54 50 36 47 71 ...
 $ Gasto_total                  : int  1617 27 776 53 422 716 590 169 46 49 ...
 $ estado_civil                 : Factor w/ 3 levels "Alone","Casado",..: 3 3 2 2 2 2 3 2 2 2 ...
 $ Cantidad_hijos               : int  0 2 0 1 1 1 1 1 1 2 ...
 $ Tamaño_Familia               : num  1 3 2 3 3 3 2 3 3 4 ...
 $ Padre_de_Familia             : num  0 1 0 1 1 1 1 1 1 1 ...
 $ Educacion                    : Factor w/ 3 levels "básica","Pos_grado",..: 3 3 3 3 2 2 3 2 2 2 ...</code></pre>
</div>
</div>
</section>
<section id="deteccion-de-posibles-outliers-en-la-data" class="level2">
<h2 class="anchored" data-anchor-id="deteccion-de-posibles-outliers-en-la-data">deteccion de posibles outliers en la data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>detectar_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">nombre_var =</span> <span class="st">""</span>) {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  limite_inferior <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  limite_superior <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  outliers <span class="ot">&lt;-</span> x <span class="sc">&lt;</span> limite_inferior <span class="sc">|</span> x <span class="sc">&gt;</span> limite_superior</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(x, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Boxplot de"</span>, nombre_var), </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Valor"</span>, <span class="at">col =</span> <span class="st">"orange"</span>) </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">outliers =</span> <span class="fu">which</span>(outliers),</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cantidad =</span> <span class="fu">sum</span>(outliers),</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">limites =</span> <span class="fu">c</span>(<span class="at">inferior =</span> limite_inferior, <span class="at">superior =</span> limite_superior)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Variables con posibles ouliers</p>
<ul>
<li>Ingreso</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>Ingreso, <span class="st">"Ingreso"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
[1]  165  618  656  688 1301 1654 2133 2234

$cantidad
[1] 8

$limites
inferior.25% superior.75% 
   -13587.75    117416.25 </code></pre>
</div>
</div>
<pre><code>- Edad</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>Edad, <span class="st">"Edad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
[1] 193 240 340

$cantidad
[1] 3

$limites
inferior.25% superior.75% 
          17           89 </code></pre>
</div>
</div>
<pre><code>- gasto_vinos</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>gasto_vinos, <span class="st">"Gasto en Vinos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
 [1]  112  162  296  425  431  467  498  516  524  544  560  825  827  871  918
[16]  938  988  991 1002 1011 1053 1192 1459 1489 1493 1578 1642 1750 1923 1954
[31] 1962 1993 2068 2099 2128

$cantidad
[1] 35

$limites
inferior.25% superior.75% 
        -697         1225 </code></pre>
</div>
</div>
<pre><code>- gasto_frutas</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>gasto_frutas, <span class="st">"Gasto en Frutas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
  [1]    1   30   46   54   73   77   78  103  108  110  111  117  118  127  133
 [16]  169  199  202  229  242  244  249  253  267  277  278  287  289  293  306
 [31]  313  337  340  348  354  361  391  393  402  419  427  448  460  464  507
 [46]  510  512  514  520  529  538  557  558  562  564  592  593  615  631  633
 [61]  638  643  645  647  659  673  682  687  690  702  724  728  740  754  755
 [76]  763  768  772  791  799  804  813  826  836  847  856  885  898  903  906
 [91]  925  928  929  941  943  961  966  971  975  985  987 1017 1031 1032 1048
[106] 1051 1063 1067 1072 1076 1081 1090 1101 1135 1145 1152 1158 1173 1180 1200
[121] 1202 1207 1217 1243 1266 1281 1289 1290 1314 1321 1337 1356 1359 1390 1414
[136] 1422 1430 1445 1452 1453 1470 1481 1485 1487 1489 1493 1496 1508 1509 1511
[151] 1521 1522 1527 1538 1553 1560 1564 1573 1590 1599 1602 1613 1616 1623 1628
[166] 1631 1649 1669 1672 1673 1681 1696 1700 1701 1723 1734 1735 1746 1750 1760
[181] 1768 1783 1790 1814 1824 1829 1854 1870 1872 1878 1881 1888 1891 1892 1895
[196] 1911 1913 1922 1925 1935 1944 1947 1954 1966 1977 1983 2014 2015 2037 2038
[211] 2040 2042 2049 2057 2058 2072 2074 2075 2085 2094 2097 2169 2173 2186 2204
[226] 2207 2218

$cantidad
[1] 227

$limites
inferior.25% superior.75% 
         -47           81 </code></pre>
</div>
</div>
<pre><code>- gasto_carne</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>gasto_carne, <span class="st">"Gasto en Carne"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
  [1]   22   30   52   77   78   89  105  117  127  136  141  143  165  198  229
 [16]  241  249  289  293  314  339  340  341  358  361  367  391  416  425  427
 [31]  457  491  516  520  547  558  562  592  593  610  628  635  637  642  645
 [46]  651  687  688  690  724  727  736  751  754  767  791  799  815  821  838
 [61]  846  853  879  885  886  907  911  915  928  943  944  967  987  988  989
 [76] 1031 1032 1035 1053 1067 1085 1091 1114 1130 1134 1135 1154 1164 1180 1205
 [91] 1207 1214 1260 1262 1270 1281 1289 1299 1302 1312 1351 1359 1386 1444 1445
[106] 1452 1453 1459 1477 1487 1493 1514 1521 1522 1529 1543 1573 1582 1583 1590
[121] 1602 1611 1613 1649 1654 1672 1673 1687 1711 1714 1722 1723 1724 1744 1746
[136] 1802 1809 1810 1814 1828 1829 1842 1851 1853 1854 1859 1870 1888 1891 1892
[151] 1928 1946 1953 1954 1959 1966 1983 1991 1993 2011 2013 2042 2087 2110 2132
[166] 2152 2164 2168 2177 2188 2191 2194 2212 2214 2229

$cantidad
[1] 175

$limites
inferior.25% superior.75% 
        -308          556 </code></pre>
</div>
</div>
<pre><code>- gasto_pescado</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>gasto_pescado, <span class="st">"Gasto en Pescado"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
  [1]    1   13   18   40   46   54   56   57   68   71   78  103  117  118  127
 [16]  160  167  169  189  192  202  215  232  241  244  248  249  250  267  269
 [31]  278  283  287  289  293  306  336  346  361  367  369  402  416  419  427
 [46]  433  457  460  462  464  486  493  508  529  532  563  564  593  610  627
 [61]  633  647  651  682  683  687  716  724  728  737  745  748  763  767  768
 [76]  772  780  799  805  810  845  853  856  876  885  886  895  898  906  915
 [91]  916  920  922  925  927  928  937  944  976  977  985  989  994  999 1011
[106] 1017 1032 1048 1051 1053 1060 1067 1090 1101 1114 1134 1158 1159 1160 1170
[121] 1191 1200 1258 1260 1266 1272 1281 1285 1289 1299 1302 1312 1333 1334 1337
[136] 1352 1355 1356 1359 1366 1408 1414 1430 1444 1445 1474 1477 1481 1485 1496
[151] 1508 1522 1527 1543 1564 1568 1599 1602 1616 1623 1645 1660 1675 1690 1700
[166] 1709 1714 1730 1736 1768 1774 1780 1789 1793 1800 1801 1802 1809 1815 1828
[181] 1837 1865 1870 1872 1878 1891 1895 1906 1911 1912 1924 1935 1944 1947 1966
[196] 1968 1969 1977 1991 1997 2007 2011 2014 2040 2049 2075 2085 2094 2097 2124
[211] 2135 2152 2164 2167 2173 2176 2177 2187 2189 2191 2194 2207 2218

$cantidad
[1] 223

$limites
inferior.25% superior.75% 
       -67.5        120.5 </code></pre>
</div>
</div>
<pre><code>- gasto_dulces</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>gasto_dulces, <span class="st">"Gasto en Dulces"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
  [1]    1   13   28   41   52   56   57   65   69   78   89  103  108  117  118
 [16]  131  160  177  192  198  203  204  212  215  232  241  242  253  267  269
 [31]  277  279  288  289  306  337  341  346  348  352  358  361  369  391  393
 [46]  412  419  424  427  430  433  448  457  460  462  464  471  514  545  547
 [61]  555  558  562  564  592  593  628  633  635  651  659  663  673  674  680
 [76]  682  687  699  706  716  717  719  724  737  748  753  756  768  780  781
 [91]  799  804  810  815  818  826  836  853  876  885  886  898  901  925  929
[106]  941  957  961  971  975  984  988 1011 1017 1031 1032 1035 1051 1068 1076
[121] 1081 1083 1091 1101 1106 1112 1114 1152 1154 1158 1169 1173 1180 1200 1223
[136] 1236 1243 1254 1258 1260 1266 1282 1299 1305 1314 1323 1333 1334 1335 1337
[151] 1364 1366 1433 1445 1447 1459 1485 1493 1496 1499 1500 1507 1508 1509 1511
[166] 1513 1514 1527 1529 1543 1553 1564 1573 1592 1602 1607 1611 1623 1627 1631
[181] 1652 1672 1675 1681 1687 1700 1709 1712 1724 1730 1734 1735 1746 1749 1760
[196] 1761 1768 1780 1789 1810 1814 1815 1818 1825 1837 1851 1864 1872 1877 1878
[211] 1881 1888 1889 1892 1899 1913 1922 1923 1929 1930 1944 1948 1961 1967 1969
[226] 1983 1994 1996 2007 2013 2014 2034 2042 2050 2066 2084 2085 2097 2128 2164
[241] 2167 2169 2173 2176 2191 2194 2218 2236

$cantidad
[1] 248

$limites
inferior.25% superior.75% 
         -47           81 </code></pre>
</div>
</div>
<pre><code>- gasto_gold</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>gasto_gold, <span class="st">"Gasto en Gold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
  [1]   19   28   46   54   56   63   89   99  125  126  127  133  180  183  199
 [16]  210  227  244  245  249  253  267  271  277  280  282  288  293  336  340
 [31]  346  348  366  369  379  388  430  432  464  491  494  504  522  587  593
 [46]  627  637  641  644  645  647  650  663  673  681  703  709  716  719  722
 [61]  724  728  730  737  746  753  758  765  772  780  788  789  798  809  832
 [76]  836  838  840  846  847  856  875  886  893  896  897  906  913  922  928
 [91]  935  941  944  947  957  966  980  985  988 1003 1008 1011 1035 1041 1044
[106] 1049 1053 1062 1067 1068 1072 1085 1086 1116 1118 1145 1196 1255 1257 1267
[121] 1279 1281 1285 1289 1302 1310 1321 1323 1324 1326 1329 1333 1352 1399 1422
[136] 1444 1449 1466 1468 1474 1475 1481 1514 1522 1554 1560 1620 1642 1649 1659
[151] 1675 1701 1716 1730 1744 1748 1749 1789 1801 1807 1815 1818 1824 1825 1828
[166] 1839 1840 1870 1877 1878 1891 1892 1914 1915 1916 1922 1944 1947 1962 1976
[181] 1983 2025 2032 2034 2035 2041 2058 2059 2063 2082 2094 2099 2119 2124 2135
[196] 2152 2161 2167 2169 2172 2174 2176 2179 2189 2195 2199 2236

$cantidad
[1] 207

$limites
inferior.25% superior.75% 
       -61.5        126.5 </code></pre>
</div>
</div>
<pre><code>- gasto_total</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>Gasto_total, <span class="st">"Gasto Total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
[1] 1180 1493 1573

$cantidad
[1] 3

$limites
inferior.25% superior.75% 
   -1396.375     2510.625 </code></pre>
</div>
</div>
<pre><code>- Dias_ultima_compra </code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>Dias_ultima_compra, <span class="st">"Dias desde la última compra"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
integer(0)

$cantidad
[1] 0

$limites
inferior.25% superior.75% 
         -51          149 </code></pre>
</div>
</div>
<pre><code>- cantidad_compra_con_descuento</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>cantidad_compra_con_descuento, <span class="st">"Cantidad de compra con descuento"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
 [1]   22   25   50   55   70   91  149  165  213  214  231  245  288  365  384
[16]  405  420  433  456  473  480  533  582  628  646  688  729  732  733  773
[31]  809  856  877  889  941  965  978 1013 1023 1043 1061 1068 1110 1126 1148
[46] 1157 1162 1246 1267 1274 1310 1343 1363 1462 1481 1488 1491 1494 1501 1504
[61] 1507 1526 1557 1570 1589 1620 1624 1643 1661 1789 1804 1833 1840 1847 1866
[76] 1894 1916 1985 2042 2045 2060 2091 2145 2199 2227 2237

$cantidad
[1] 86

$limites
inferior.25% superior.75% 
          -2            6 </code></pre>
</div>
</div>
<pre><code>- cantidad_compra_web   </code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>cantidad_compra_web, <span class="st">"Cantidad compra web"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
[1]   28 1807 1899 1976

$cantidad
[1] 4

$limites
inferior.25% superior.75% 
          -4           12 </code></pre>
</div>
</div>
<pre><code>- cantidad_compra_catalogo</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>cantidad_compra_catalogo, <span class="st">"Cantidad compra catalogo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
 [1]   22  105  165  289  587  592  628  637  688  765  778  935  985 1213 1453
[16] 1466 1493 1654 1746 1829 1907 1941 1959

$cantidad
[1] 23

$limites
inferior.25% superior.75% 
          -6           10 </code></pre>
</div>
</div>
<pre><code>- cantidad_compra_tienda </code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>cantidad_compra_tienda, <span class="st">"Cantidad compra en tienda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
integer(0)

$cantidad
[1] 0

$limites
inferior.25% superior.75% 
        -4.5         15.5 </code></pre>
</div>
</div>
<pre><code>- cantidad_visitas_web_mes </code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>cantidad_visitas_web_mes, <span class="st">"Cantidad de visitas web al mes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
[1]   10  775  982 1043 1246 1329 1525 1847

$cantidad
[1] 8

$limites
inferior.25% superior.75% 
          -3           13 </code></pre>
</div>
</div>
</section>
<section id="datos-seleccionados" class="level2">
<h2 class="anchored" data-anchor-id="datos-seleccionados">Datos seleccionados</h2>
<p>Luego de revisar los datos, para los objetivos de la practica se seleccionaron las siguientes variables</p>
<ul>
<li>Gasto total</li>
<li>Cantidad Compra total (suma de las variables cantidad compra)</li>
<li>Edad</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cantidad_compra_total =</span> cantidad_compra_con_descuento <span class="sc">+</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                                 cantidad_compra_web <span class="sc">+</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                                 cantidad_compra_catalogo <span class="sc">+</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                                 cantidad_compra_tienda) <span class="sc">|&gt;</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Gasto_total, Edad, Cantidad_compra_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eliminamos-outliers" class="level2">
<h2 class="anchored" data-anchor-id="eliminamos-outliers">Eliminamos outliers</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>eliminar_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(data)) {</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data[[col]], <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data[[col]], <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(data[[col]] <span class="sc">&gt;=</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR <span class="sc">&amp;</span> data[[col]] <span class="sc">&lt;=</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">eliminar_outliers</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comprovamos-si-quedan-outliers" class="level3">
<h3 class="anchored" data-anchor-id="comprovamos-si-quedan-outliers">Comprovamos si quedan outliers</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>Gasto_total, <span class="st">"Gasto total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
integer(0)

$cantidad
[1] 0

$limites
inferior.25% superior.75% 
   -1388.875     2498.125 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>Edad, <span class="st">"Edad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
integer(0)

$cantidad
[1] 0

$limites
inferior.25% superior.75% 
          17           89 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detectar_outliers</span>(data<span class="sc">$</span>Cantidad_compra_total, <span class="st">"Cantida Compra Total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-41-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$outliers
integer(0)

$cantidad
[1] 0

$limites
inferior.25% superior.75% 
       -11.5         40.5 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="análisis-exploratorio-de-datos" class="level1">
<h1>Análisis exploratorio de datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span>  </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> Gasto_total, <span class="at">y=</span>Cantidad_compra_total)) <span class="sc">+</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span>  </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> Gasto_total, <span class="at">y=</span>Edad)) <span class="sc">+</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> data<span class="sc">$</span>Gasto_total,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> data<span class="sc">$</span>Cantidad_compra_total,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">z =</span> data<span class="sc">$</span>Edad,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">rownames</span>(data),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"markers"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Gasto total"</span>),</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Cantidad de Compra Total"</span>),</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Edad"</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7e4e9d730dc60fdf620f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7e4e9d730dc60fdf620f">{"x":{"visdat":{"44a21b6e139":["function () ","plotlyVisDat"]},"cur_data":"44a21b6e139","attrs":{"44a21b6e139":{"x":[1617,27,776,53,422,716,590,169,46,49,19,61,1102,310,46,1315,96,317,1782,133,316,972,544,444,75,257,637,131,1672,30,318,120,302,1196,65,913,81,67,902,1395,53,22,186,31,984,122,55,124,1319,507,1693,72,1617,606,1957,1093,29,46,518,1438,612,884,606,1076,34,11,1274,653,1562,1253,109,863,661,65,13,1890,2209,18,692,165,16,79,318,778,56,151,372,1366,194,603,18,985,32,43,45,606,63,978,410,72,55,1169,1120,1097,29,187,910,145,850,969,1820,608,730,551,114,1724,577,81,33,660,80,30,43,1135,559,1923,90,404,661,463,632,725,725,279,1482,29,106,49,38,2077,1053,1385,871,312,877,68,22,211,127,459,460,429,89,1021,1381,306,18,162,1231,13,1706,121,1293,1608,88,421,259,1117,89,36,57,148,93,119,1835,1318,45,10,978,191,57,1033,66,43,50,39,608,1581,68,80,1282,91,315,31,834,1600,1270,263,535,1295,1150,1240,38,35,53,293,65,1804,241,1101,264,541,1198,482,17,1615,285,1135,114,1047,714,185,1245,189,576,1103,1753,17,433,1588,22,19,1117,69,23,605,57,2088,1009,26,1627,1102,17,1690,1390,2126,1531,64,26,1112,210,1148,33,1101,322,44,17,31,845,275,25,275,90,1495,184,981,67,1635,60,231,48,99,770,957,818,925,908,102,576,317,461,37,70,930,859,1478,390,52,137,1919,68,25,1374,32,100,825,916,62,728,90,273,66,1213,107,1157,546,241,53,37,1611,1508,235,32,102,401,28,1052,680,30,20,1307,630,1283,65,37,38,160,23,71,1161,59,33,946,1442,62,1674,1538,139,1182,507,18,940,42,1190,44,16,835,1443,1029,1188,1277,49,99,1670,900,425,2153,636,57,25,494,693,1348,51,1932,990,30,254,29,1371,73,120,81,37,1377,51,17,22,324,211,19,41,492,1005,114,1173,1738,222,1127,209,787,1598,186,47,27,96,64,1040,163,343,446,41,70,272,46,490,79,915,1485,369,1073,1242,78,1378,1474,751,48,45,10,1435,2119,20,1795,1188,43,1008,1688,684,1082,1068,57,46,733,467,122,36,34,156,14,37,34,20,192,1379,48,428,868,1001,59,431,971,348,2059,265,270,1289,893,926,135,1495,120,1288,1743,15,542,890,1388,17,906,44,25,973,31,518,530,506,70,54,296,266,747,895,1053,735,20,205,2092,309,1722,900,682,663,43,1816,976,746,64,32,263,1445,46,1210,945,1157,137,730,216,943,347,1924,397,2089,138,42,777,1902,52,1651,358,1727,210,42,1291,442,1895,411,521,1168,493,260,46,319,96,1062,232,76,54,201,406,1919,662,41,1600,134,69,21,54,91,526,162,1008,240,795,1772,64,1957,78,1572,795,889,331,265,1065,11,21,17,369,38,177,279,62,1230,182,49,75,227,215,444,47,143,55,63,1867,611,473,55,81,2086,1478,49,382,69,67,30,63,79,42,819,1151,594,129,213,67,28,45,1193,268,266,37,37,882,373,35,107,42,326,404,95,939,33,981,36,1237,1825,103,191,1586,963,889,93,1587,16,1375,393,1477,1179,1005,1348,1307,486,2252,235,1724,235,1092,599,2008,48,1174,67,365,6,165,210,1095,223,597,22,1064,74,26,60,20,59,34,198,1048,574,1029,670,990,11,1241,576,172,664,928,2074,467,257,1146,689,2114,1346,1044,493,957,270,29,121,126,23,57,636,1004,734,614,1453,1621,187,1443,57,637,948,59,18,903,112,596,233,1511,1152,48,1185,21,965,869,16,1947,71,65,1380,1027,411,836,11,480,606,284,1472,1677,1335,334,18,1338,1099,97,63,109,902,1574,38,960,28,1215,1497,449,1064,1757,1440,1006,1226,1171,92,99,66,564,1427,86,833,242,1869,1364,183,450,758,1507,654,81,137,16,93,1158,43,1525,1230,29,25,24,38,57,47,813,629,377,1612,729,50,270,177,315,767,1071,1580,60,573,41,170,1167,1526,458,63,405,1027,1478,72,48,726,860,1497,495,20,570,769,55,1808,55,577,162,1957,1576,1616,36,1482,22,63,680,542,50,39,1043,385,1633,46,761,76,290,89,70,1066,2009,1345,764,195,53,368,544,1853,35,446,1180,41,727,40,1062,40,292,15,341,369,401,393,10,486,69,1727,995,45,182,989,1677,595,156,1226,128,86,68,16,55,2114,2018,263,55,564,1281,83,353,1003,14,902,1139,797,1638,401,84,928,203,858,409,282,1423,1449,28,67,199,1453,1253,1198,178,1990,976,1001,1919,350,1650,46,1228,95,62,1761,467,1149,2052,1127,1416,1113,125,966,32,833,46,960,1829,779,811,1120,725,1187,2302,66,1250,683,305,50,995,41,77,171,131,54,53,475,694,96,361,1079,578,64,149,231,728,1778,93,23,662,1198,81,92,491,1564,926,1910,411,94,1085,23,6,54,1150,1415,405,1908,2486,1315,45,1789,19,573,805,108,23,1493,89,936,343,528,1901,724,58,297,488,859,1574,69,17,2194,116,279,103,44,406,1363,236,39,137,79,63,1314,71,58,702,94,80,22,1211,1461,1968,1091,55,1366,313,62,92,72,655,704,54,178,1033,36,122,122,1123,497,691,1363,12,2440,56,37,968,270,278,1250,938,1178,1155,653,49,506,38,1650,1826,18,906,46,1477,766,47,467,2116,1298,22,396,20,967,357,1401,15,2087,981,17,523,23,1192,1958,133,777,73,121,424,868,756,12,937,1862,367,443,267,61,1323,63,64,562,312,1156,1104,16,2008,44,1574,63,426,96,635,757,125,332,135,330,384,1722,78,24,1168,957,15,57,1956,2013,326,77,1313,30,315,660,74,46,86,1103,61,145,684,411,27,1060,1459,18,1833,237,48,515,1020,1370,1026,301,684,499,1004,218,606,75,106,990,1097,16,34,1711,438,75,225,18,470,91,504,235,1232,88,17,24,60,1020,155,51,1812,1461,96,160,139,908,183,1161,988,1072,174,758,195,31,1084,685,1672,43,49,133,363,545,1065,2047,296,140,530,152,1598,114,101,25,789,87,90,1215,811,61,405,72,189,40,63,52,39,805,130,1631,34,152,21,71,899,711,351,8,119,21,10,973,1536,992,1529,860,928,418,587,641,23,2279,49,1779,1804,48,83,1862,793,84,183,1383,999,825,246,610,76,1286,30,99,1192,362,2130,1229,38,485,434,44,496,78,2346,794,17,26,76,15,62,198,49,802,1736,57,59,2302,37,310,1305,832,401,1501,1189,1194,656,1540,311,820,274,57,448,44,102,61,1643,397,1121,473,50,1678,58,170,373,1196,101,316,1400,1424,844,311,1149,129,32,299,320,441,1178,85,24,112,30,410,800,1313,1483,1258,28,227,1555,861,103,634,1918,131,586,62,447,939,797,1143,415,30,187,251,237,91,35,493,971,371,396,68,322,317,222,177,45,21,45,1899,42,22,41,1440,325,95,42,72,20,789,15,59,908,417,289,769,188,354,727,146,319,794,454,152,797,1690,20,1428,209,545,96,222,61,44,8,817,1371,42,60,78,23,19,61,449,37,38,1131,34,294,48,289,30,125,156,70,22,65,1930,2283,310,1319,879,1244,690,209,1134,1507,57,529,1091,180,77,2349,534,556,637,46,44,47,795,586,1574,13,1471,65,175,40,1078,1115,134,1540,87,217,1034,1180,819,32,46,1159,860,1631,444,1910,380,736,269,612,75,1045,55,1064,1443,1366,436,38,436,747,1396,928,642,1048,943,907,1198,120,1658,1638,73,275,854,78,106,106,1923,1662,84,48,5,733,1234,112,1658,55,1513,271,904,120,103,269,22,1156,1086,1128,72,964,1383,18,793,100,80,167,677,23,92,641,1106,1033,1174,25,240,20,102,1034,156,458,17,792,92,407,1269,841,633,1019,1315,54,52,436,268,147,1798,137,507,15,1105,974,66,778,49,169,299,221,1682,155,892,58,311,95,424,47,339,1410,35,562,2352,1334,32,41,39,1141,710,401,506,1538,57,1722,270,31,882,16,311,227,1152,122,77,1289,561,211,233,1092,601,54,78,1095,244,116,15,425,734,638,894,41,31,34,1750,612,29,823,20,396,813,1179,138,55,1511,117,1730,32,67,335,825,694,1792,496,231,902,68,71,76,772,47,1586,1529,265,1603,2091,981,1533,82,244,36,404,71,1572,122,41,10,304,37,1754,815,1001,1157,688,1319,21,31,67,708,25,746,32,1695,1080,72,57,660,103,153,1220,279,745,264,2157,1526,69,1597,64,497,1067,31,211,877,11,2034,1991,1686,324,69,252,54,964,1327,68,60,55,1456,563,1504,564,1125,358,42,184,460,145,1376,792,1382,28,1033,882,2231,1101,369,48,467,44,38,81,167,45,664,622,48,461,1073,55,976,20,1149,43,224,101,209,968,1165,24,252,165,269,102,461,47,144,1338,917,318,253,502,119,1250,969,76,62,1382,84,255,43,398,76,902,823,1179,1921,185,433,34,907,416,44,1588,1797,40,1143,914,1502,1338,27,763,1331,525,9,953,68,131,882,1149,37,388,1428,1633,173,99,215,929,219,174,92,1052,275,587,1662,159,1024,35,1042,395,557,9,69,486,34,1365,13,1401,1574,1323,1217,103,84,1536,581,928,14,424,960,1555,656,55,20,367,2257,42,1049,48,685,39,43,835,1515,1039,1596,1828,34,149,946,28,450,46,1702,820,382,2126,2069,72,732,801,236,80,1685,277,507,68,49,397,39,306,976,1028,70,46,51,1263,1490,1564,1815,1198,416,85,47,137,21,70,909,1676,1735,1191,24,1182,1280,1336,749,91,414,44,63,901,38,455,775,15,38,1512,43,42,1089,162,1272,1173,816,74,134,157,561,1336,2092,463,1130,20,377,1544,138,1012,1766,45,161,144,1734,823,1138,1429,1371,982,44,318,434,198,359,576,88,63,27,193,101,2211,140,415,22,263,393,147,443,1958,174,2217,1691,25,809,895,484,413,331,25,13,115,16,92,52,1464,441,283,747,1870,165,1941,839,1655,23,66,37,21,22,78,79,265,1175,1305,46,25,46,874,100,930,868,45,1260,414,392,1109,639,79,1665,692,1392,44,50,467,223,158,1211,1575,1208,43,527,932,71,54,129,1615,1034,1088,721,137,47,1244,41,1174,993,100,1680,98,48,519,715,37,653,1455,602,26,102,97,207,176,450,433,1366,1564,1001,961,1518,56,22,400,26,350,1216,874,40,1367,264,2053,1376,45,976,51,1264,75,57,140,497,266,2006,615,1021,22,133,437,1013,57,1038,1573,28,123,13,132,732,66,1631,608,1822,1282,8,43,1931,8,103,1169,395,258,25,185,180,22,44,94,81,798,1334,38,61,300,88,54,1782,68,258,31,66,174,28,731,274,1701,312,414,1565,29,94,1338,1092,1479,54,568,1199,873,1213,731,2043,1893,424,575,257,56,542,125,69,40,1016,907,1566,1169,46,1644,59,17,1853,1528,35,141,546,500,61,106,704,424,849,85,199,1147,54,43,53,521,1623,45,1435,32,16,52,1234,15,415,470,1438,53,51,679,586,653,468,1679,50,84,1049,22,62,30,1341,444,1241,843,172],"y":[25,6,21,8,19,22,21,10,6,2,4,6,16,15,5,26,9,13,26,8,12,17,20,20,8,14,27,9,26,8,11,9,17,18,6,28,9,7,24,21,7,4,9,8,16,10,5,10,28,17,29,7,21,23,27,21,6,7,19,21,22,24,19,16,5,4,32,18,19,21,9,30,24,8,4,19,22,4,21,12,4,9,11,27,7,13,17,19,10,29,4,15,5,10,6,22,7,25,16,7,7,27,16,20,5,13,26,9,14,24,17,20,25,21,8,15,20,7,7,22,9,6,5,27,16,16,8,17,23,19,23,19,19,16,23,6,9,6,7,22,17,23,25,12,15,6,4,16,8,16,19,17,11,26,21,15,4,9,18,4,27,11,20,37,9,18,12,15,9,6,7,8,8,7,28,25,7,4,25,10,9,24,6,6,5,7,18,24,7,5,28,8,16,6,23,17,17,15,19,18,29,26,6,4,5,17,6,29,15,20,19,26,17,20,4,25,12,28,7,16,22,13,32,12,16,18,17,4,23,14,4,5,29,8,5,19,11,22,16,5,22,31,6,16,21,20,25,7,6,29,11,26,6,19,16,10,4,6,25,15,4,17,11,19,11,13,8,14,10,12,10,9,23,23,12,17,22,10,16,13,15,7,7,23,33,22,16,5,10,19,9,4,23,5,7,12,28,11,21,7,13,10,23,7,18,18,11,11,7,24,23,16,7,8,15,6,21,21,4,4,23,24,18,9,5,5,12,4,6,19,5,7,22,22,5,22,21,8,20,18,4,16,6,15,8,4,26,22,18,18,24,7,7,15,14,16,22,21,10,4,22,19,26,7,16,16,5,16,5,23,9,11,5,5,20,5,4,4,14,16,4,8,17,26,7,19,19,12,16,10,23,24,12,6,5,11,10,23,13,11,24,5,9,14,6,19,8,17,35,16,19,19,9,21,26,29,7,6,4,16,22,4,27,19,7,24,16,21,39,25,7,5,23,17,10,7,5,10,4,5,5,4,11,17,7,16,27,27,7,16,27,19,24,14,13,19,16,22,9,19,9,20,17,4,20,25,33,4,30,6,5,26,6,17,19,21,6,6,12,15,19,29,17,21,5,10,21,14,22,15,20,22,6,18,27,21,6,5,9,21,5,28,24,22,8,25,12,23,16,19,17,22,11,5,17,20,7,13,13,16,10,5,20,15,17,19,19,17,23,12,7,16,7,16,12,9,9,11,14,20,20,8,14,8,10,6,7,8,18,8,25,16,21,19,8,20,7,19,26,26,15,12,19,4,4,4,16,6,11,12,7,21,11,10,8,16,15,20,5,7,7,11,22,20,18,6,7,21,20,5,15,9,6,6,9,10,5,23,17,20,11,12,7,5,6,18,12,12,5,7,25,18,6,1,5,17,17,6,14,5,21,7,20,34,9,12,25,14,26,7,21,4,32,14,26,18,26,21,23,15,13,17,30,11,28,17,19,6,32,7,15,0,10,11,26,12,22,4,24,6,5,5,4,7,5,12,28,21,17,20,16,4,21,17,12,20,23,30,15,12,17,20,22,21,15,22,13,12,5,9,8,4,8,20,28,20,20,21,15,12,22,6,20,14,5,4,26,8,20,13,11,17,7,31,4,16,21,6,16,12,6,24,23,21,26,4,23,23,16,14,26,19,13,4,20,30,8,9,9,21,20,9,24,4,28,22,17,24,25,21,24,23,20,8,8,8,19,21,6,19,12,17,29,8,18,21,20,25,9,1,4,8,18,6,22,19,6,5,4,5,7,12,24,22,17,14,17,6,15,9,13,23,26,24,10,21,5,10,28,25,21,6,17,20,22,5,7,16,27,22,18,4,19,21,7,18,7,18,8,20,24,17,6,22,5,6,18,20,7,6,28,14,27,5,20,9,14,11,11,17,19,19,23,11,11,13,20,25,6,18,31,5,22,6,26,7,17,4,17,13,17,17,4,16,7,17,16,10,12,23,18,23,9,28,11,9,7,4,7,22,19,15,7,24,20,7,18,25,4,24,25,20,25,17,11,18,11,16,13,16,18,18,4,6,10,22,19,31,10,18,14,15,20,14,25,5,19,7,9,26,16,19,19,16,21,20,7,25,5,19,8,17,30,26,23,22,20,12,18,9,19,20,13,6,16,6,9,12,7,5,12,16,22,8,16,26,20,7,13,17,21,23,10,4,24,18,11,10,18,24,24,19,21,9,28,4,0,6,29,23,16,19,26,27,7,17,4,22,24,8,4,23,9,25,16,20,12,22,7,16,21,23,20,10,4,21,8,18,7,9,15,20,11,5,8,10,6,25,6,7,21,7,7,5,32,22,20,16,5,19,13,11,9,6,21,18,8,16,14,5,10,7,27,18,25,20,4,25,7,5,21,15,12,22,17,28,26,20,6,17,8,23,33,4,24,8,25,23,7,14,21,25,6,15,4,13,19,16,4,20,26,6,22,4,17,20,9,17,9,10,15,13,15,4,25,17,14,20,13,6,21,6,8,19,19,16,16,4,19,9,14,5,12,6,23,22,9,16,8,14,20,18,7,4,25,17,4,5,24,21,14,9,20,8,14,22,7,7,8,25,11,9,31,16,4,27,24,4,26,12,10,26,15,11,25,12,31,17,21,12,22,6,9,17,16,4,5,16,17,7,13,4,17,9,19,11,21,12,4,5,7,26,10,5,16,25,6,9,10,22,8,19,14,27,12,22,11,6,17,22,26,6,5,9,15,18,31,21,15,11,17,13,24,8,10,4,22,7,11,20,22,7,18,9,14,5,10,7,5,25,8,24,5,12,5,7,23,10,16,15,11,4,4,27,13,28,34,17,23,18,16,19,4,23,6,17,27,8,7,17,29,9,10,19,16,24,14,25,9,22,4,8,22,18,19,28,6,17,13,5,18,7,23,21,4,5,8,4,7,10,5,25,15,10,2,18,6,16,19,26,19,23,28,32,21,23,15,26,14,9,17,5,8,5,27,15,26,16,8,28,7,9,2,17,8,17,21,27,20,13,17,8,5,14,13,16,28,6,4,8,5,16,24,20,23,17,4,11,20,23,8,19,19,10,22,7,22,27,15,16,17,5,12,11,12,8,6,22,28,17,20,7,15,14,10,12,5,4,6,20,5,6,5,21,17,10,5,6,7,23,4,8,22,14,15,21,10,14,26,11,16,22,18,11,22,16,4,21,11,19,6,10,7,9,4,23,23,5,5,9,4,4,7,14,5,5,23,7,17,6,15,4,7,9,9,4,9,23,23,13,18,26,17,17,12,17,23,6,17,16,11,10,25,18,21,25,5,9,5,22,21,20,4,25,8,12,5,18,21,9,23,7,10,27,31,23,5,6,18,25,15,22,29,18,30,15,25,8,26,6,21,25,30,19,5,20,32,22,14,26,30,24,27,18,11,26,22,7,12,26,7,7,7,19,22,7,7,0,32,17,9,15,7,26,17,27,11,8,17,5,16,19,28,9,27,20,4,24,7,6,8,20,4,7,16,17,14,32,6,17,4,11,26,9,21,4,21,8,16,23,23,23,25,26,8,5,20,15,8,18,8,17,4,17,15,8,27,6,12,12,17,25,10,13,5,15,7,19,12,15,21,6,20,24,20,6,7,5,25,24,19,17,21,6,19,15,6,24,4,14,11,31,8,9,19,24,13,12,21,17,10,7,26,13,9,4,16,26,19,22,7,5,5,18,25,5,21,4,16,21,20,10,9,22,9,28,6,6,15,22,23,17,24,13,24,9,6,6,22,9,25,34,13,18,22,21,34,7,14,5,16,6,23,11,10,4,13,5,16,25,27,22,21,19,4,4,6,21,4,11,5,25,28,9,10,25,11,11,32,13,20,12,22,23,6,26,8,18,17,7,14,25,4,25,19,24,17,9,16,5,27,28,7,5,5,21,18,26,19,23,17,5,10,19,8,25,23,23,4,24,23,15,19,16,5,19,8,10,9,10,7,21,20,7,16,26,8,26,5,17,6,10,9,10,21,17,5,16,12,13,7,19,7,10,24,25,17,14,20,7,29,24,9,7,26,7,14,5,14,8,15,21,26,29,10,23,6,27,25,10,17,17,6,21,14,12,20,5,22,22,19,4,16,7,10,23,25,5,15,16,24,10,9,12,31,12,12,9,25,14,16,33,11,18,7,15,19,23,15,6,18,6,28,4,21,14,20,32,7,7,23,18,14,4,15,14,20,29,9,5,17,22,7,26,7,25,5,5,21,20,26,26,18,6,10,23,6,17,5,16,25,15,20,20,7,28,11,12,5,15,27,18,7,5,15,9,14,14,28,7,5,5,21,22,24,18,31,23,6,8,8,4,6,22,22,26,30,5,20,14,19,24,7,15,9,8,23,6,20,24,4,6,22,5,5,23,9,19,20,22,9,9,9,18,19,23,16,17,5,18,28,10,26,15,9,10,8,26,22,28,21,21,16,5,17,16,12,25,18,11,6,4,11,9,21,8,22,4,16,12,10,16,19,10,27,16,6,21,16,18,18,12,5,4,10,4,9,7,23,17,12,23,17,11,24,27,25,4,6,8,6,4,9,6,17,19,28,8,4,5,26,10,25,23,9,29,12,15,29,22,6,24,18,29,7,6,21,12,9,28,14,22,5,21,15,8,5,7,27,26,25,25,10,8,17,7,32,15,7,17,9,5,19,20,5,20,21,19,5,7,10,11,9,15,17,30,22,27,18,23,8,4,21,4,13,22,26,5,19,15,20,10,5,27,6,20,7,7,8,19,13,21,23,24,6,7,19,26,7,27,22,4,9,4,10,23,7,24,18,18,23,4,5,20,0,8,17,15,15,5,10,11,5,7,12,7,28,19,5,11,16,8,7,16,11,15,5,8,13,5,22,12,26,13,20,23,6,8,20,14,18,5,18,27,23,17,22,19,17,19,15,12,9,21,7,9,5,28,23,24,17,7,25,5,4,25,22,10,8,17,20,10,8,26,19,23,6,15,20,10,5,6,22,18,7,19,1,4,7,17,4,17,18,21,11,9,22,22,26,19,1,7,9,27,4,11,4,18,22,19,23,11],"z":[64,67,56,37,40,54,50,36,47,71,38,45,62,69,34,75,41,75,72,36,39,72,67,70,52,45,35,32,56,32,58,51,69,75,70,51,45,48,78,41,36,64,62,46,45,25,53,70,67,64,57,44,44,43,66,55,33,39,53,39,46,69,70,73,50,54,42,63,51,67,48,62,46,69,44,49,45,45,56,36,52,48,58,34,61,51,64,48,54,64,64,48,49,51,38,61,49,70,38,61,62,42,76,62,42,57,52,43,61,42,30,58,30,41,59,51,43,54,52,68,54,36,45,38,56,37,68,60,65,69,63,52,58,57,54,45,62,48,56,29,45,59,47,33,45,46,40,48,55,68,52,49,33,69,72,63,43,44,66,63,76,37,46,48,55,68,62,33,64,56,39,51,62,54,46,73,51,62,70,45,33,75,37,60,38,51,55,45,57,43,32,33,48,44,41,67,67,48,69,53,43,44,56,37,33,58,55,67,65,67,53,47,36,44,43,73,67,41,33,52,51,41,59,43,45,69,49,35,55,59,50,70,56,46,39,63,48,53,63,50,31,63,57,49,68,33,52,46,36,47,63,54,47,60,57,57,64,42,53,51,43,69,55,58,51,51,51,68,38,46,61,58,58,65,40,35,53,40,45,75,47,46,47,69,65,55,72,37,52,41,50,56,69,33,35,39,56,63,65,43,33,37,60,55,74,57,29,45,54,32,45,55,65,49,36,70,51,50,47,56,60,68,64,45,37,71,35,38,32,65,50,38,61,53,49,56,33,35,52,71,48,69,56,51,50,45,64,35,55,47,45,43,66,52,78,73,64,52,43,43,54,52,61,45,59,46,37,46,51,55,49,46,51,32,60,52,52,36,67,48,40,50,53,61,72,53,42,42,28,75,53,30,50,37,34,41,65,56,47,61,66,56,49,50,47,58,39,45,66,34,59,78,46,27,40,50,48,38,39,47,80,68,35,32,32,53,60,32,54,57,51,65,55,72,50,35,32,73,75,32,47,62,49,57,45,68,66,52,50,41,45,49,55,37,69,39,57,72,63,58,46,52,66,51,70,50,46,41,40,43,33,65,49,44,49,44,48,49,47,46,61,57,45,47,52,69,63,45,66,57,77,59,43,50,72,77,71,60,31,36,65,68,45,32,29,62,40,42,57,62,75,46,60,31,62,77,56,34,30,68,34,35,63,44,57,61,46,52,44,59,39,70,54,54,69,40,44,52,37,39,45,31,57,41,53,48,58,32,50,58,72,69,43,39,51,62,43,41,50,51,58,71,59,70,42,51,47,53,43,51,40,44,53,51,55,65,47,70,54,70,38,50,66,60,66,62,37,46,56,44,49,46,52,52,43,40,60,61,66,73,55,35,48,65,46,56,52,77,48,54,52,47,56,45,43,61,60,50,72,43,66,45,46,61,44,44,51,63,51,61,48,59,69,59,71,50,61,73,62,57,74,50,51,51,44,63,61,36,47,71,66,46,68,63,74,55,58,36,46,41,65,62,47,34,53,50,57,59,51,41,46,47,58,42,36,41,58,54,39,66,54,45,49,32,52,61,51,63,69,72,60,26,72,60,61,48,43,43,33,53,35,51,70,73,50,35,56,46,68,39,46,61,43,51,63,56,67,37,56,45,55,66,45,56,30,72,68,43,73,48,72,48,69,32,52,68,65,71,43,57,69,46,26,51,67,49,63,46,52,42,43,49,57,42,62,40,54,33,43,69,66,44,34,56,65,42,70,56,49,64,68,56,63,66,50,47,45,51,49,49,35,61,53,43,45,76,64,71,43,60,59,67,56,48,53,51,65,70,77,63,45,50,64,49,49,40,49,46,66,35,51,45,67,49,43,41,49,60,58,62,62,67,59,63,37,45,29,54,41,54,65,49,41,41,44,71,47,33,40,61,51,30,65,58,41,47,67,64,55,47,42,48,36,55,32,52,52,34,32,46,48,55,35,43,42,38,62,45,40,43,68,50,38,65,43,49,46,46,40,49,51,68,62,59,43,48,56,38,30,78,49,65,63,47,35,63,51,54,48,52,44,60,50,47,35,55,29,58,49,27,67,61,39,67,67,66,28,52,73,35,42,43,39,28,45,47,32,70,32,69,50,50,51,50,46,69,59,38,68,35,34,39,42,44,46,42,45,48,50,45,45,56,69,48,64,54,59,52,46,41,62,48,48,47,41,33,53,33,62,50,59,62,56,69,67,61,56,42,43,71,47,43,52,45,65,67,49,40,32,67,26,43,64,48,65,65,34,40,34,67,67,68,69,53,58,42,45,43,53,50,70,56,52,48,45,48,47,68,55,43,54,43,34,63,57,50,50,52,44,48,41,63,49,50,68,62,67,30,59,35,56,55,61,37,55,56,55,72,51,38,36,47,70,69,34,72,63,34,48,57,60,29,56,65,43,50,55,66,68,63,60,40,45,53,43,56,50,65,39,51,44,51,63,38,63,48,47,62,49,56,42,63,35,39,42,46,42,35,51,49,61,69,51,47,56,67,38,48,61,37,50,38,38,55,43,53,42,48,42,67,59,55,44,36,69,70,54,43,45,36,47,53,59,32,60,68,32,43,59,76,47,40,65,67,35,78,57,42,47,61,58,45,47,60,70,56,65,56,27,47,49,53,53,73,52,25,47,31,64,42,61,69,40,40,71,64,60,63,50,36,56,69,59,47,51,52,61,69,52,53,56,52,49,60,44,62,63,42,64,65,56,31,64,56,64,66,49,52,49,46,56,58,30,58,35,48,64,40,63,62,66,35,46,66,50,35,43,38,45,50,65,49,32,69,37,54,59,74,43,50,29,53,48,46,56,69,54,49,58,51,66,46,45,52,48,38,39,61,69,46,58,51,73,63,77,58,49,55,53,50,46,57,43,46,38,50,64,70,70,51,49,52,49,50,65,50,48,44,58,67,43,55,75,43,50,68,36,51,42,55,45,56,39,49,61,65,56,66,32,59,56,48,49,37,61,63,53,44,47,59,39,46,39,76,42,52,59,73,43,46,39,38,69,39,59,44,72,31,39,46,62,38,45,59,65,28,34,56,39,59,43,75,58,50,53,29,47,71,44,63,45,48,53,63,46,61,56,61,52,61,46,36,50,51,66,65,63,57,48,73,49,45,41,42,49,48,49,46,49,65,47,49,53,52,60,49,68,64,51,54,70,68,71,68,44,49,52,77,31,42,55,73,49,48,49,49,55,52,62,51,47,49,63,49,38,48,36,48,54,42,60,35,57,38,69,72,42,73,75,63,50,64,39,48,49,56,68,54,56,52,50,49,51,47,71,62,66,43,35,58,68,69,71,51,51,44,55,52,63,67,65,51,34,60,42,61,40,41,45,45,51,75,66,49,50,71,43,31,62,44,52,62,33,46,48,44,48,66,47,49,46,50,63,33,46,56,35,44,41,59,43,49,51,38,50,45,48,48,45,73,63,34,61,46,63,46,46,33,33,32,62,50,54,32,60,43,68,57,35,34,58,64,46,70,56,65,59,47,54,59,45,60,45,38,45,33,67,36,69,57,67,71,64,75,67,35,44,61,39,74,29,45,65,74,71,55,34,48,69,56,41,34,59,66,33,56,54,48,61,37,50,46,56,65,66,61,60,58,44,31,48,57,33,43,31,46,44,37,38,34,56,65,56,50,39,62,58,69,50,58,39,45,74,52,62,43,73,66,67,76,52,45,52,57,40,42,40,61,47,40,54,71,39,60,58,44,74,43,67,67,49,40,63,53,45,55,32,36,54,62,51,54,36,70,35,66,51,30,46,42,45,41,43,50,66,38,69,52,41,53,50,32,70,34,36,40,31,69,50,38,64,70,45,66,32,48,48,37,65,56,43,48,35,62,43,55,29,37,65,44,47,45,42,38,30,59,39,42,66,56,60,70,57,62,66,55,63,67,54,58,62,50,57,38,76,74,52,69,74,75,52,72,60,47,41,72,50,42,53,50,66,49,57,42,46,44,35,65,41,39,60,46,47,75,36,69,54,66,36,44,48,37,42,45,53,62,50,54,48,38,42,42,71,58,59,45,69,61,66,44,57,40,45,47,70,55,70,63,55,57,65,47,55,58,52,29,67,38,39,70,65,60,59,50,50,53,43,52,56,35,63,46,34,62,59,47,44,43,51,64,66,67,39,68,53,64,56,46,58,31,55,33,26,46,43,60,37,50,70,45,49,36,55,46,42,50,39,48,53,37,50,44,54,57,49,73,69,34,62,63,70,46,37,52,53,52,36,37,64,50,46,39,33,32,36,53,47,72,43,67,76,71,57,38,34,50,53,67,50,35,62,41,61,51,50,54,58,53,31,40,45,56,44,49,65,78,62,44,52,51,64,56,47,74,39,53,70,46,65,72,62,48,37,71,44,37,45,70,39,47,53,67,81,45,70,45,57,71,45,65,31,71,56,59,43,69,55,74,49,58,72,43,55,38,50,46,50,52,58,53,42,37,37,47,70,59,46,64,43,30,35,65,58,50,74,63,61,41,46,46,48,41,51,54,51,55,49,44,51,57,62,55,63,35,44,40,63,46,38,54,70,49,43,39,65,69,56,42,56,68,72,36,74,66,45,46,37,71,44,70,37,39,30,51,40,42,50,51,62,48,51,74,70,46,62,66,68,56,48,45,71,52,52,40,39,43,47,70,73,69,37,42,72,65,52,34,38,51,44,61,50,67,48,66,61,33,78,52,29,62,41,50,47,52,45,28,72,71,46,65,45,46,45,72,37,47,49,35,59,51,72,60,66,40,68,47,67,52,40,69,59,50,45,45,41,65,64,49,55,35,56,47,45,45,72,41,64,56,52,51,67,55,47,50,53,64,48,64,50,61,48,59,63,49,45,52,45,38,57,46,66,56,57,41,64,72,29,47,67,31,37,40,56,51,46,70,66,46,54,48,50,66,47,49,57,43,64,61,49,65,64,49,38,50,74,64,64,69,47,48,67,46,31,52,48,43,31,53,41,67,58,58,66,40,71,26,45,67,38,73,43,36,42,39,42,58,51,53,42,59,43,49,37,51,35,44,47,54,75,40,65,67],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171","1172","1173","1174","1175","1176","1177","1178","1179","1180","1181","1182","1183","1184","1185","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1196","1197","1198","1199","1200","1201","1202","1203","1204","1205","1206","1207","1208","1209","1210","1211","1212","1213","1214","1215","1216","1217","1218","1219","1220","1221","1222","1223","1224","1225","1226","1227","1228","1229","1230","1231","1232","1233","1234","1235","1236","1237","1238","1239","1240","1241","1242","1243","1244","1245","1246","1247","1248","1249","1250","1251","1252","1253","1254","1255","1256","1257","1258","1259","1260","1261","1262","1263","1264","1265","1266","1267","1268","1269","1270","1271","1272","1273","1274","1275","1276","1277","1278","1279","1280","1281","1282","1283","1284","1285","1286","1287","1288","1289","1290","1291","1292","1293","1294","1295","1296","1297","1298","1299","1300","1301","1302","1303","1304","1305","1306","1307","1308","1309","1310","1311","1312","1313","1314","1315","1316","1317","1318","1319","1320","1321","1322","1323","1324","1325","1326","1327","1328","1329","1330","1331","1332","1333","1334","1335","1336","1337","1338","1339","1340","1341","1342","1343","1344","1345","1346","1347","1348","1349","1350","1351","1352","1353","1354","1355","1356","1357","1358","1359","1360","1361","1362","1363","1364","1365","1366","1367","1368","1369","1370","1371","1372","1373","1374","1375","1376","1377","1378","1379","1380","1381","1382","1383","1384","1385","1386","1387","1388","1389","1390","1391","1392","1393","1394","1395","1396","1397","1398","1399","1400","1401","1402","1403","1404","1405","1406","1407","1408","1409","1410","1411","1412","1413","1414","1415","1416","1417","1418","1419","1420","1421","1422","1423","1424","1425","1426","1427","1428","1429","1430","1431","1432","1433","1434","1435","1436","1437","1438","1439","1440","1441","1442","1443","1444","1445","1446","1447","1448","1449","1450","1451","1452","1453","1454","1455","1456","1457","1458","1459","1460","1461","1462","1463","1464","1465","1466","1467","1468","1469","1470","1471","1472","1473","1474","1475","1476","1477","1478","1479","1480","1481","1482","1483","1484","1485","1486","1487","1488","1489","1490","1491","1492","1493","1494","1495","1496","1497","1498","1499","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510","1511","1512","1513","1514","1515","1516","1517","1518","1519","1520","1521","1522","1523","1524","1525","1526","1527","1528","1529","1530","1531","1532","1533","1534","1535","1536","1537","1538","1539","1540","1541","1542","1543","1544","1545","1546","1547","1548","1549","1550","1551","1552","1553","1554","1555","1556","1557","1558","1559","1560","1561","1562","1563","1564","1565","1566","1567","1568","1569","1570","1571","1572","1573","1574","1575","1576","1577","1578","1579","1580","1581","1582","1583","1584","1585","1586","1587","1588","1589","1590","1591","1592","1593","1594","1595","1596","1597","1598","1599","1600","1601","1602","1603","1604","1605","1606","1607","1608","1609","1610","1611","1612","1613","1614","1615","1616","1617","1618","1619","1620","1621","1622","1623","1624","1625","1626","1627","1628","1629","1630","1631","1632","1633","1634","1635","1636","1637","1638","1639","1640","1641","1642","1643","1644","1645","1646","1647","1648","1649","1650","1651","1652","1653","1654","1655","1656","1657","1658","1659","1660","1661","1662","1663","1664","1665","1666","1667","1668","1669","1670","1671","1672","1673","1674","1675","1676","1677","1678","1679","1680","1681","1682","1683","1684","1685","1686","1687","1688","1689","1690","1691","1692","1693","1694","1695","1696","1697","1698","1699","1700","1701","1702","1703","1704","1705","1706","1707","1708","1709","1710","1711","1712","1713","1714","1715","1716","1717","1718","1719","1720","1721","1722","1723","1724","1725","1726","1727","1728","1729","1730","1731","1732","1733","1734","1735","1736","1737","1738","1739","1740","1741","1742","1743","1744","1745","1746","1747","1748","1749","1750","1751","1752","1753","1754","1755","1756","1757","1758","1759","1760","1761","1762","1763","1764","1765","1766","1767","1768","1769","1770","1771","1772","1773","1774","1775","1776","1777","1778","1779","1780","1781","1782","1783","1784","1785","1786","1787","1788","1789","1790","1791","1792","1793","1794","1795","1796","1797","1798","1799","1800","1801","1802","1803","1804","1805","1806","1807","1808","1809","1810","1811","1812","1813","1814","1815","1816","1817","1818","1819","1820","1821","1822","1823","1824","1825","1826","1827","1828","1829","1830","1831","1832","1833","1834","1835","1836","1837","1838","1839","1840","1841","1842","1843","1844","1845","1846","1847","1848","1849","1850","1851","1852","1853","1854","1855","1856","1857","1858","1859","1860","1861","1862","1863","1864","1865","1866","1867","1868","1869","1870","1871","1872","1873","1874","1875","1876","1877","1878","1879","1880","1881","1882","1883","1884","1885","1886","1887","1888","1889","1890","1891","1892","1893","1894","1895","1896","1897","1898","1899","1900","1901","1902","1903","1904","1905","1906","1907","1908","1909","1910","1911","1912","1913","1914","1915","1916","1917","1918","1919","1920","1921","1922","1923","1924","1925","1926","1927","1928","1929","1930","1931","1932","1933","1934","1935","1936","1937","1938","1939","1940","1941","1942","1943","1944","1945","1946","1947","1948","1949","1950","1951","1952","1953","1954","1955","1956","1957","1958","1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","2025","2026","2027","2028","2029","2030","2031","2032","2033","2034","2035","2036","2037","2038","2039","2040","2041","2042","2043","2044","2045","2046","2047","2048","2049","2050","2051","2052","2053","2054","2055","2056","2057","2058","2059","2060","2061","2062","2063","2064","2065","2066","2067","2068","2069","2070","2071","2072","2073","2074","2075","2076","2077","2078","2079","2080","2081","2082","2083","2084","2085","2086","2087","2088","2089","2090","2091","2092","2093","2094","2095","2096","2097","2098","2099","2100","2101","2102","2103","2104","2105","2106","2107","2108","2109","2110","2111","2112","2113","2114","2115","2116","2117","2118","2119","2120","2121","2122","2123","2124","2125","2126","2127","2128","2129","2130","2131","2132","2133","2134","2135","2136","2137","2138","2139","2140","2141","2142","2143","2144","2145","2146","2147","2148","2149","2150","2151","2152","2153","2154","2155","2156","2157","2158","2159","2160","2161","2162","2163","2164","2165","2166","2167","2168","2169","2170","2171","2172","2173","2174","2175","2176","2177","2178","2179","2180","2181","2182","2183","2184","2185","2186","2187","2188","2189","2190","2191","2192","2193","2194","2195","2196","2197","2198","2199","2200","2201","2202","2203","2204","2205","2206","2207","2208","2209","2210","2211","2212","2213","2214","2215","2216","2217","2218","2219","2220","2221","2222","2223","2224","2225","2226","2227","2228","2229","2230","2231","2232"],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Gasto total"},"yaxis":{"title":"Cantidad de Compra Total"},"zaxis":{"title":"Edad"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1617,27,776,53,422,716,590,169,46,49,19,61,1102,310,46,1315,96,317,1782,133,316,972,544,444,75,257,637,131,1672,30,318,120,302,1196,65,913,81,67,902,1395,53,22,186,31,984,122,55,124,1319,507,1693,72,1617,606,1957,1093,29,46,518,1438,612,884,606,1076,34,11,1274,653,1562,1253,109,863,661,65,13,1890,2209,18,692,165,16,79,318,778,56,151,372,1366,194,603,18,985,32,43,45,606,63,978,410,72,55,1169,1120,1097,29,187,910,145,850,969,1820,608,730,551,114,1724,577,81,33,660,80,30,43,1135,559,1923,90,404,661,463,632,725,725,279,1482,29,106,49,38,2077,1053,1385,871,312,877,68,22,211,127,459,460,429,89,1021,1381,306,18,162,1231,13,1706,121,1293,1608,88,421,259,1117,89,36,57,148,93,119,1835,1318,45,10,978,191,57,1033,66,43,50,39,608,1581,68,80,1282,91,315,31,834,1600,1270,263,535,1295,1150,1240,38,35,53,293,65,1804,241,1101,264,541,1198,482,17,1615,285,1135,114,1047,714,185,1245,189,576,1103,1753,17,433,1588,22,19,1117,69,23,605,57,2088,1009,26,1627,1102,17,1690,1390,2126,1531,64,26,1112,210,1148,33,1101,322,44,17,31,845,275,25,275,90,1495,184,981,67,1635,60,231,48,99,770,957,818,925,908,102,576,317,461,37,70,930,859,1478,390,52,137,1919,68,25,1374,32,100,825,916,62,728,90,273,66,1213,107,1157,546,241,53,37,1611,1508,235,32,102,401,28,1052,680,30,20,1307,630,1283,65,37,38,160,23,71,1161,59,33,946,1442,62,1674,1538,139,1182,507,18,940,42,1190,44,16,835,1443,1029,1188,1277,49,99,1670,900,425,2153,636,57,25,494,693,1348,51,1932,990,30,254,29,1371,73,120,81,37,1377,51,17,22,324,211,19,41,492,1005,114,1173,1738,222,1127,209,787,1598,186,47,27,96,64,1040,163,343,446,41,70,272,46,490,79,915,1485,369,1073,1242,78,1378,1474,751,48,45,10,1435,2119,20,1795,1188,43,1008,1688,684,1082,1068,57,46,733,467,122,36,34,156,14,37,34,20,192,1379,48,428,868,1001,59,431,971,348,2059,265,270,1289,893,926,135,1495,120,1288,1743,15,542,890,1388,17,906,44,25,973,31,518,530,506,70,54,296,266,747,895,1053,735,20,205,2092,309,1722,900,682,663,43,1816,976,746,64,32,263,1445,46,1210,945,1157,137,730,216,943,347,1924,397,2089,138,42,777,1902,52,1651,358,1727,210,42,1291,442,1895,411,521,1168,493,260,46,319,96,1062,232,76,54,201,406,1919,662,41,1600,134,69,21,54,91,526,162,1008,240,795,1772,64,1957,78,1572,795,889,331,265,1065,11,21,17,369,38,177,279,62,1230,182,49,75,227,215,444,47,143,55,63,1867,611,473,55,81,2086,1478,49,382,69,67,30,63,79,42,819,1151,594,129,213,67,28,45,1193,268,266,37,37,882,373,35,107,42,326,404,95,939,33,981,36,1237,1825,103,191,1586,963,889,93,1587,16,1375,393,1477,1179,1005,1348,1307,486,2252,235,1724,235,1092,599,2008,48,1174,67,365,6,165,210,1095,223,597,22,1064,74,26,60,20,59,34,198,1048,574,1029,670,990,11,1241,576,172,664,928,2074,467,257,1146,689,2114,1346,1044,493,957,270,29,121,126,23,57,636,1004,734,614,1453,1621,187,1443,57,637,948,59,18,903,112,596,233,1511,1152,48,1185,21,965,869,16,1947,71,65,1380,1027,411,836,11,480,606,284,1472,1677,1335,334,18,1338,1099,97,63,109,902,1574,38,960,28,1215,1497,449,1064,1757,1440,1006,1226,1171,92,99,66,564,1427,86,833,242,1869,1364,183,450,758,1507,654,81,137,16,93,1158,43,1525,1230,29,25,24,38,57,47,813,629,377,1612,729,50,270,177,315,767,1071,1580,60,573,41,170,1167,1526,458,63,405,1027,1478,72,48,726,860,1497,495,20,570,769,55,1808,55,577,162,1957,1576,1616,36,1482,22,63,680,542,50,39,1043,385,1633,46,761,76,290,89,70,1066,2009,1345,764,195,53,368,544,1853,35,446,1180,41,727,40,1062,40,292,15,341,369,401,393,10,486,69,1727,995,45,182,989,1677,595,156,1226,128,86,68,16,55,2114,2018,263,55,564,1281,83,353,1003,14,902,1139,797,1638,401,84,928,203,858,409,282,1423,1449,28,67,199,1453,1253,1198,178,1990,976,1001,1919,350,1650,46,1228,95,62,1761,467,1149,2052,1127,1416,1113,125,966,32,833,46,960,1829,779,811,1120,725,1187,2302,66,1250,683,305,50,995,41,77,171,131,54,53,475,694,96,361,1079,578,64,149,231,728,1778,93,23,662,1198,81,92,491,1564,926,1910,411,94,1085,23,6,54,1150,1415,405,1908,2486,1315,45,1789,19,573,805,108,23,1493,89,936,343,528,1901,724,58,297,488,859,1574,69,17,2194,116,279,103,44,406,1363,236,39,137,79,63,1314,71,58,702,94,80,22,1211,1461,1968,1091,55,1366,313,62,92,72,655,704,54,178,1033,36,122,122,1123,497,691,1363,12,2440,56,37,968,270,278,1250,938,1178,1155,653,49,506,38,1650,1826,18,906,46,1477,766,47,467,2116,1298,22,396,20,967,357,1401,15,2087,981,17,523,23,1192,1958,133,777,73,121,424,868,756,12,937,1862,367,443,267,61,1323,63,64,562,312,1156,1104,16,2008,44,1574,63,426,96,635,757,125,332,135,330,384,1722,78,24,1168,957,15,57,1956,2013,326,77,1313,30,315,660,74,46,86,1103,61,145,684,411,27,1060,1459,18,1833,237,48,515,1020,1370,1026,301,684,499,1004,218,606,75,106,990,1097,16,34,1711,438,75,225,18,470,91,504,235,1232,88,17,24,60,1020,155,51,1812,1461,96,160,139,908,183,1161,988,1072,174,758,195,31,1084,685,1672,43,49,133,363,545,1065,2047,296,140,530,152,1598,114,101,25,789,87,90,1215,811,61,405,72,189,40,63,52,39,805,130,1631,34,152,21,71,899,711,351,8,119,21,10,973,1536,992,1529,860,928,418,587,641,23,2279,49,1779,1804,48,83,1862,793,84,183,1383,999,825,246,610,76,1286,30,99,1192,362,2130,1229,38,485,434,44,496,78,2346,794,17,26,76,15,62,198,49,802,1736,57,59,2302,37,310,1305,832,401,1501,1189,1194,656,1540,311,820,274,57,448,44,102,61,1643,397,1121,473,50,1678,58,170,373,1196,101,316,1400,1424,844,311,1149,129,32,299,320,441,1178,85,24,112,30,410,800,1313,1483,1258,28,227,1555,861,103,634,1918,131,586,62,447,939,797,1143,415,30,187,251,237,91,35,493,971,371,396,68,322,317,222,177,45,21,45,1899,42,22,41,1440,325,95,42,72,20,789,15,59,908,417,289,769,188,354,727,146,319,794,454,152,797,1690,20,1428,209,545,96,222,61,44,8,817,1371,42,60,78,23,19,61,449,37,38,1131,34,294,48,289,30,125,156,70,22,65,1930,2283,310,1319,879,1244,690,209,1134,1507,57,529,1091,180,77,2349,534,556,637,46,44,47,795,586,1574,13,1471,65,175,40,1078,1115,134,1540,87,217,1034,1180,819,32,46,1159,860,1631,444,1910,380,736,269,612,75,1045,55,1064,1443,1366,436,38,436,747,1396,928,642,1048,943,907,1198,120,1658,1638,73,275,854,78,106,106,1923,1662,84,48,5,733,1234,112,1658,55,1513,271,904,120,103,269,22,1156,1086,1128,72,964,1383,18,793,100,80,167,677,23,92,641,1106,1033,1174,25,240,20,102,1034,156,458,17,792,92,407,1269,841,633,1019,1315,54,52,436,268,147,1798,137,507,15,1105,974,66,778,49,169,299,221,1682,155,892,58,311,95,424,47,339,1410,35,562,2352,1334,32,41,39,1141,710,401,506,1538,57,1722,270,31,882,16,311,227,1152,122,77,1289,561,211,233,1092,601,54,78,1095,244,116,15,425,734,638,894,41,31,34,1750,612,29,823,20,396,813,1179,138,55,1511,117,1730,32,67,335,825,694,1792,496,231,902,68,71,76,772,47,1586,1529,265,1603,2091,981,1533,82,244,36,404,71,1572,122,41,10,304,37,1754,815,1001,1157,688,1319,21,31,67,708,25,746,32,1695,1080,72,57,660,103,153,1220,279,745,264,2157,1526,69,1597,64,497,1067,31,211,877,11,2034,1991,1686,324,69,252,54,964,1327,68,60,55,1456,563,1504,564,1125,358,42,184,460,145,1376,792,1382,28,1033,882,2231,1101,369,48,467,44,38,81,167,45,664,622,48,461,1073,55,976,20,1149,43,224,101,209,968,1165,24,252,165,269,102,461,47,144,1338,917,318,253,502,119,1250,969,76,62,1382,84,255,43,398,76,902,823,1179,1921,185,433,34,907,416,44,1588,1797,40,1143,914,1502,1338,27,763,1331,525,9,953,68,131,882,1149,37,388,1428,1633,173,99,215,929,219,174,92,1052,275,587,1662,159,1024,35,1042,395,557,9,69,486,34,1365,13,1401,1574,1323,1217,103,84,1536,581,928,14,424,960,1555,656,55,20,367,2257,42,1049,48,685,39,43,835,1515,1039,1596,1828,34,149,946,28,450,46,1702,820,382,2126,2069,72,732,801,236,80,1685,277,507,68,49,397,39,306,976,1028,70,46,51,1263,1490,1564,1815,1198,416,85,47,137,21,70,909,1676,1735,1191,24,1182,1280,1336,749,91,414,44,63,901,38,455,775,15,38,1512,43,42,1089,162,1272,1173,816,74,134,157,561,1336,2092,463,1130,20,377,1544,138,1012,1766,45,161,144,1734,823,1138,1429,1371,982,44,318,434,198,359,576,88,63,27,193,101,2211,140,415,22,263,393,147,443,1958,174,2217,1691,25,809,895,484,413,331,25,13,115,16,92,52,1464,441,283,747,1870,165,1941,839,1655,23,66,37,21,22,78,79,265,1175,1305,46,25,46,874,100,930,868,45,1260,414,392,1109,639,79,1665,692,1392,44,50,467,223,158,1211,1575,1208,43,527,932,71,54,129,1615,1034,1088,721,137,47,1244,41,1174,993,100,1680,98,48,519,715,37,653,1455,602,26,102,97,207,176,450,433,1366,1564,1001,961,1518,56,22,400,26,350,1216,874,40,1367,264,2053,1376,45,976,51,1264,75,57,140,497,266,2006,615,1021,22,133,437,1013,57,1038,1573,28,123,13,132,732,66,1631,608,1822,1282,8,43,1931,8,103,1169,395,258,25,185,180,22,44,94,81,798,1334,38,61,300,88,54,1782,68,258,31,66,174,28,731,274,1701,312,414,1565,29,94,1338,1092,1479,54,568,1199,873,1213,731,2043,1893,424,575,257,56,542,125,69,40,1016,907,1566,1169,46,1644,59,17,1853,1528,35,141,546,500,61,106,704,424,849,85,199,1147,54,43,53,521,1623,45,1435,32,16,52,1234,15,415,470,1438,53,51,679,586,653,468,1679,50,84,1049,22,62,30,1341,444,1241,843,172],"y":[25,6,21,8,19,22,21,10,6,2,4,6,16,15,5,26,9,13,26,8,12,17,20,20,8,14,27,9,26,8,11,9,17,18,6,28,9,7,24,21,7,4,9,8,16,10,5,10,28,17,29,7,21,23,27,21,6,7,19,21,22,24,19,16,5,4,32,18,19,21,9,30,24,8,4,19,22,4,21,12,4,9,11,27,7,13,17,19,10,29,4,15,5,10,6,22,7,25,16,7,7,27,16,20,5,13,26,9,14,24,17,20,25,21,8,15,20,7,7,22,9,6,5,27,16,16,8,17,23,19,23,19,19,16,23,6,9,6,7,22,17,23,25,12,15,6,4,16,8,16,19,17,11,26,21,15,4,9,18,4,27,11,20,37,9,18,12,15,9,6,7,8,8,7,28,25,7,4,25,10,9,24,6,6,5,7,18,24,7,5,28,8,16,6,23,17,17,15,19,18,29,26,6,4,5,17,6,29,15,20,19,26,17,20,4,25,12,28,7,16,22,13,32,12,16,18,17,4,23,14,4,5,29,8,5,19,11,22,16,5,22,31,6,16,21,20,25,7,6,29,11,26,6,19,16,10,4,6,25,15,4,17,11,19,11,13,8,14,10,12,10,9,23,23,12,17,22,10,16,13,15,7,7,23,33,22,16,5,10,19,9,4,23,5,7,12,28,11,21,7,13,10,23,7,18,18,11,11,7,24,23,16,7,8,15,6,21,21,4,4,23,24,18,9,5,5,12,4,6,19,5,7,22,22,5,22,21,8,20,18,4,16,6,15,8,4,26,22,18,18,24,7,7,15,14,16,22,21,10,4,22,19,26,7,16,16,5,16,5,23,9,11,5,5,20,5,4,4,14,16,4,8,17,26,7,19,19,12,16,10,23,24,12,6,5,11,10,23,13,11,24,5,9,14,6,19,8,17,35,16,19,19,9,21,26,29,7,6,4,16,22,4,27,19,7,24,16,21,39,25,7,5,23,17,10,7,5,10,4,5,5,4,11,17,7,16,27,27,7,16,27,19,24,14,13,19,16,22,9,19,9,20,17,4,20,25,33,4,30,6,5,26,6,17,19,21,6,6,12,15,19,29,17,21,5,10,21,14,22,15,20,22,6,18,27,21,6,5,9,21,5,28,24,22,8,25,12,23,16,19,17,22,11,5,17,20,7,13,13,16,10,5,20,15,17,19,19,17,23,12,7,16,7,16,12,9,9,11,14,20,20,8,14,8,10,6,7,8,18,8,25,16,21,19,8,20,7,19,26,26,15,12,19,4,4,4,16,6,11,12,7,21,11,10,8,16,15,20,5,7,7,11,22,20,18,6,7,21,20,5,15,9,6,6,9,10,5,23,17,20,11,12,7,5,6,18,12,12,5,7,25,18,6,1,5,17,17,6,14,5,21,7,20,34,9,12,25,14,26,7,21,4,32,14,26,18,26,21,23,15,13,17,30,11,28,17,19,6,32,7,15,0,10,11,26,12,22,4,24,6,5,5,4,7,5,12,28,21,17,20,16,4,21,17,12,20,23,30,15,12,17,20,22,21,15,22,13,12,5,9,8,4,8,20,28,20,20,21,15,12,22,6,20,14,5,4,26,8,20,13,11,17,7,31,4,16,21,6,16,12,6,24,23,21,26,4,23,23,16,14,26,19,13,4,20,30,8,9,9,21,20,9,24,4,28,22,17,24,25,21,24,23,20,8,8,8,19,21,6,19,12,17,29,8,18,21,20,25,9,1,4,8,18,6,22,19,6,5,4,5,7,12,24,22,17,14,17,6,15,9,13,23,26,24,10,21,5,10,28,25,21,6,17,20,22,5,7,16,27,22,18,4,19,21,7,18,7,18,8,20,24,17,6,22,5,6,18,20,7,6,28,14,27,5,20,9,14,11,11,17,19,19,23,11,11,13,20,25,6,18,31,5,22,6,26,7,17,4,17,13,17,17,4,16,7,17,16,10,12,23,18,23,9,28,11,9,7,4,7,22,19,15,7,24,20,7,18,25,4,24,25,20,25,17,11,18,11,16,13,16,18,18,4,6,10,22,19,31,10,18,14,15,20,14,25,5,19,7,9,26,16,19,19,16,21,20,7,25,5,19,8,17,30,26,23,22,20,12,18,9,19,20,13,6,16,6,9,12,7,5,12,16,22,8,16,26,20,7,13,17,21,23,10,4,24,18,11,10,18,24,24,19,21,9,28,4,0,6,29,23,16,19,26,27,7,17,4,22,24,8,4,23,9,25,16,20,12,22,7,16,21,23,20,10,4,21,8,18,7,9,15,20,11,5,8,10,6,25,6,7,21,7,7,5,32,22,20,16,5,19,13,11,9,6,21,18,8,16,14,5,10,7,27,18,25,20,4,25,7,5,21,15,12,22,17,28,26,20,6,17,8,23,33,4,24,8,25,23,7,14,21,25,6,15,4,13,19,16,4,20,26,6,22,4,17,20,9,17,9,10,15,13,15,4,25,17,14,20,13,6,21,6,8,19,19,16,16,4,19,9,14,5,12,6,23,22,9,16,8,14,20,18,7,4,25,17,4,5,24,21,14,9,20,8,14,22,7,7,8,25,11,9,31,16,4,27,24,4,26,12,10,26,15,11,25,12,31,17,21,12,22,6,9,17,16,4,5,16,17,7,13,4,17,9,19,11,21,12,4,5,7,26,10,5,16,25,6,9,10,22,8,19,14,27,12,22,11,6,17,22,26,6,5,9,15,18,31,21,15,11,17,13,24,8,10,4,22,7,11,20,22,7,18,9,14,5,10,7,5,25,8,24,5,12,5,7,23,10,16,15,11,4,4,27,13,28,34,17,23,18,16,19,4,23,6,17,27,8,7,17,29,9,10,19,16,24,14,25,9,22,4,8,22,18,19,28,6,17,13,5,18,7,23,21,4,5,8,4,7,10,5,25,15,10,2,18,6,16,19,26,19,23,28,32,21,23,15,26,14,9,17,5,8,5,27,15,26,16,8,28,7,9,2,17,8,17,21,27,20,13,17,8,5,14,13,16,28,6,4,8,5,16,24,20,23,17,4,11,20,23,8,19,19,10,22,7,22,27,15,16,17,5,12,11,12,8,6,22,28,17,20,7,15,14,10,12,5,4,6,20,5,6,5,21,17,10,5,6,7,23,4,8,22,14,15,21,10,14,26,11,16,22,18,11,22,16,4,21,11,19,6,10,7,9,4,23,23,5,5,9,4,4,7,14,5,5,23,7,17,6,15,4,7,9,9,4,9,23,23,13,18,26,17,17,12,17,23,6,17,16,11,10,25,18,21,25,5,9,5,22,21,20,4,25,8,12,5,18,21,9,23,7,10,27,31,23,5,6,18,25,15,22,29,18,30,15,25,8,26,6,21,25,30,19,5,20,32,22,14,26,30,24,27,18,11,26,22,7,12,26,7,7,7,19,22,7,7,0,32,17,9,15,7,26,17,27,11,8,17,5,16,19,28,9,27,20,4,24,7,6,8,20,4,7,16,17,14,32,6,17,4,11,26,9,21,4,21,8,16,23,23,23,25,26,8,5,20,15,8,18,8,17,4,17,15,8,27,6,12,12,17,25,10,13,5,15,7,19,12,15,21,6,20,24,20,6,7,5,25,24,19,17,21,6,19,15,6,24,4,14,11,31,8,9,19,24,13,12,21,17,10,7,26,13,9,4,16,26,19,22,7,5,5,18,25,5,21,4,16,21,20,10,9,22,9,28,6,6,15,22,23,17,24,13,24,9,6,6,22,9,25,34,13,18,22,21,34,7,14,5,16,6,23,11,10,4,13,5,16,25,27,22,21,19,4,4,6,21,4,11,5,25,28,9,10,25,11,11,32,13,20,12,22,23,6,26,8,18,17,7,14,25,4,25,19,24,17,9,16,5,27,28,7,5,5,21,18,26,19,23,17,5,10,19,8,25,23,23,4,24,23,15,19,16,5,19,8,10,9,10,7,21,20,7,16,26,8,26,5,17,6,10,9,10,21,17,5,16,12,13,7,19,7,10,24,25,17,14,20,7,29,24,9,7,26,7,14,5,14,8,15,21,26,29,10,23,6,27,25,10,17,17,6,21,14,12,20,5,22,22,19,4,16,7,10,23,25,5,15,16,24,10,9,12,31,12,12,9,25,14,16,33,11,18,7,15,19,23,15,6,18,6,28,4,21,14,20,32,7,7,23,18,14,4,15,14,20,29,9,5,17,22,7,26,7,25,5,5,21,20,26,26,18,6,10,23,6,17,5,16,25,15,20,20,7,28,11,12,5,15,27,18,7,5,15,9,14,14,28,7,5,5,21,22,24,18,31,23,6,8,8,4,6,22,22,26,30,5,20,14,19,24,7,15,9,8,23,6,20,24,4,6,22,5,5,23,9,19,20,22,9,9,9,18,19,23,16,17,5,18,28,10,26,15,9,10,8,26,22,28,21,21,16,5,17,16,12,25,18,11,6,4,11,9,21,8,22,4,16,12,10,16,19,10,27,16,6,21,16,18,18,12,5,4,10,4,9,7,23,17,12,23,17,11,24,27,25,4,6,8,6,4,9,6,17,19,28,8,4,5,26,10,25,23,9,29,12,15,29,22,6,24,18,29,7,6,21,12,9,28,14,22,5,21,15,8,5,7,27,26,25,25,10,8,17,7,32,15,7,17,9,5,19,20,5,20,21,19,5,7,10,11,9,15,17,30,22,27,18,23,8,4,21,4,13,22,26,5,19,15,20,10,5,27,6,20,7,7,8,19,13,21,23,24,6,7,19,26,7,27,22,4,9,4,10,23,7,24,18,18,23,4,5,20,0,8,17,15,15,5,10,11,5,7,12,7,28,19,5,11,16,8,7,16,11,15,5,8,13,5,22,12,26,13,20,23,6,8,20,14,18,5,18,27,23,17,22,19,17,19,15,12,9,21,7,9,5,28,23,24,17,7,25,5,4,25,22,10,8,17,20,10,8,26,19,23,6,15,20,10,5,6,22,18,7,19,1,4,7,17,4,17,18,21,11,9,22,22,26,19,1,7,9,27,4,11,4,18,22,19,23,11],"z":[64,67,56,37,40,54,50,36,47,71,38,45,62,69,34,75,41,75,72,36,39,72,67,70,52,45,35,32,56,32,58,51,69,75,70,51,45,48,78,41,36,64,62,46,45,25,53,70,67,64,57,44,44,43,66,55,33,39,53,39,46,69,70,73,50,54,42,63,51,67,48,62,46,69,44,49,45,45,56,36,52,48,58,34,61,51,64,48,54,64,64,48,49,51,38,61,49,70,38,61,62,42,76,62,42,57,52,43,61,42,30,58,30,41,59,51,43,54,52,68,54,36,45,38,56,37,68,60,65,69,63,52,58,57,54,45,62,48,56,29,45,59,47,33,45,46,40,48,55,68,52,49,33,69,72,63,43,44,66,63,76,37,46,48,55,68,62,33,64,56,39,51,62,54,46,73,51,62,70,45,33,75,37,60,38,51,55,45,57,43,32,33,48,44,41,67,67,48,69,53,43,44,56,37,33,58,55,67,65,67,53,47,36,44,43,73,67,41,33,52,51,41,59,43,45,69,49,35,55,59,50,70,56,46,39,63,48,53,63,50,31,63,57,49,68,33,52,46,36,47,63,54,47,60,57,57,64,42,53,51,43,69,55,58,51,51,51,68,38,46,61,58,58,65,40,35,53,40,45,75,47,46,47,69,65,55,72,37,52,41,50,56,69,33,35,39,56,63,65,43,33,37,60,55,74,57,29,45,54,32,45,55,65,49,36,70,51,50,47,56,60,68,64,45,37,71,35,38,32,65,50,38,61,53,49,56,33,35,52,71,48,69,56,51,50,45,64,35,55,47,45,43,66,52,78,73,64,52,43,43,54,52,61,45,59,46,37,46,51,55,49,46,51,32,60,52,52,36,67,48,40,50,53,61,72,53,42,42,28,75,53,30,50,37,34,41,65,56,47,61,66,56,49,50,47,58,39,45,66,34,59,78,46,27,40,50,48,38,39,47,80,68,35,32,32,53,60,32,54,57,51,65,55,72,50,35,32,73,75,32,47,62,49,57,45,68,66,52,50,41,45,49,55,37,69,39,57,72,63,58,46,52,66,51,70,50,46,41,40,43,33,65,49,44,49,44,48,49,47,46,61,57,45,47,52,69,63,45,66,57,77,59,43,50,72,77,71,60,31,36,65,68,45,32,29,62,40,42,57,62,75,46,60,31,62,77,56,34,30,68,34,35,63,44,57,61,46,52,44,59,39,70,54,54,69,40,44,52,37,39,45,31,57,41,53,48,58,32,50,58,72,69,43,39,51,62,43,41,50,51,58,71,59,70,42,51,47,53,43,51,40,44,53,51,55,65,47,70,54,70,38,50,66,60,66,62,37,46,56,44,49,46,52,52,43,40,60,61,66,73,55,35,48,65,46,56,52,77,48,54,52,47,56,45,43,61,60,50,72,43,66,45,46,61,44,44,51,63,51,61,48,59,69,59,71,50,61,73,62,57,74,50,51,51,44,63,61,36,47,71,66,46,68,63,74,55,58,36,46,41,65,62,47,34,53,50,57,59,51,41,46,47,58,42,36,41,58,54,39,66,54,45,49,32,52,61,51,63,69,72,60,26,72,60,61,48,43,43,33,53,35,51,70,73,50,35,56,46,68,39,46,61,43,51,63,56,67,37,56,45,55,66,45,56,30,72,68,43,73,48,72,48,69,32,52,68,65,71,43,57,69,46,26,51,67,49,63,46,52,42,43,49,57,42,62,40,54,33,43,69,66,44,34,56,65,42,70,56,49,64,68,56,63,66,50,47,45,51,49,49,35,61,53,43,45,76,64,71,43,60,59,67,56,48,53,51,65,70,77,63,45,50,64,49,49,40,49,46,66,35,51,45,67,49,43,41,49,60,58,62,62,67,59,63,37,45,29,54,41,54,65,49,41,41,44,71,47,33,40,61,51,30,65,58,41,47,67,64,55,47,42,48,36,55,32,52,52,34,32,46,48,55,35,43,42,38,62,45,40,43,68,50,38,65,43,49,46,46,40,49,51,68,62,59,43,48,56,38,30,78,49,65,63,47,35,63,51,54,48,52,44,60,50,47,35,55,29,58,49,27,67,61,39,67,67,66,28,52,73,35,42,43,39,28,45,47,32,70,32,69,50,50,51,50,46,69,59,38,68,35,34,39,42,44,46,42,45,48,50,45,45,56,69,48,64,54,59,52,46,41,62,48,48,47,41,33,53,33,62,50,59,62,56,69,67,61,56,42,43,71,47,43,52,45,65,67,49,40,32,67,26,43,64,48,65,65,34,40,34,67,67,68,69,53,58,42,45,43,53,50,70,56,52,48,45,48,47,68,55,43,54,43,34,63,57,50,50,52,44,48,41,63,49,50,68,62,67,30,59,35,56,55,61,37,55,56,55,72,51,38,36,47,70,69,34,72,63,34,48,57,60,29,56,65,43,50,55,66,68,63,60,40,45,53,43,56,50,65,39,51,44,51,63,38,63,48,47,62,49,56,42,63,35,39,42,46,42,35,51,49,61,69,51,47,56,67,38,48,61,37,50,38,38,55,43,53,42,48,42,67,59,55,44,36,69,70,54,43,45,36,47,53,59,32,60,68,32,43,59,76,47,40,65,67,35,78,57,42,47,61,58,45,47,60,70,56,65,56,27,47,49,53,53,73,52,25,47,31,64,42,61,69,40,40,71,64,60,63,50,36,56,69,59,47,51,52,61,69,52,53,56,52,49,60,44,62,63,42,64,65,56,31,64,56,64,66,49,52,49,46,56,58,30,58,35,48,64,40,63,62,66,35,46,66,50,35,43,38,45,50,65,49,32,69,37,54,59,74,43,50,29,53,48,46,56,69,54,49,58,51,66,46,45,52,48,38,39,61,69,46,58,51,73,63,77,58,49,55,53,50,46,57,43,46,38,50,64,70,70,51,49,52,49,50,65,50,48,44,58,67,43,55,75,43,50,68,36,51,42,55,45,56,39,49,61,65,56,66,32,59,56,48,49,37,61,63,53,44,47,59,39,46,39,76,42,52,59,73,43,46,39,38,69,39,59,44,72,31,39,46,62,38,45,59,65,28,34,56,39,59,43,75,58,50,53,29,47,71,44,63,45,48,53,63,46,61,56,61,52,61,46,36,50,51,66,65,63,57,48,73,49,45,41,42,49,48,49,46,49,65,47,49,53,52,60,49,68,64,51,54,70,68,71,68,44,49,52,77,31,42,55,73,49,48,49,49,55,52,62,51,47,49,63,49,38,48,36,48,54,42,60,35,57,38,69,72,42,73,75,63,50,64,39,48,49,56,68,54,56,52,50,49,51,47,71,62,66,43,35,58,68,69,71,51,51,44,55,52,63,67,65,51,34,60,42,61,40,41,45,45,51,75,66,49,50,71,43,31,62,44,52,62,33,46,48,44,48,66,47,49,46,50,63,33,46,56,35,44,41,59,43,49,51,38,50,45,48,48,45,73,63,34,61,46,63,46,46,33,33,32,62,50,54,32,60,43,68,57,35,34,58,64,46,70,56,65,59,47,54,59,45,60,45,38,45,33,67,36,69,57,67,71,64,75,67,35,44,61,39,74,29,45,65,74,71,55,34,48,69,56,41,34,59,66,33,56,54,48,61,37,50,46,56,65,66,61,60,58,44,31,48,57,33,43,31,46,44,37,38,34,56,65,56,50,39,62,58,69,50,58,39,45,74,52,62,43,73,66,67,76,52,45,52,57,40,42,40,61,47,40,54,71,39,60,58,44,74,43,67,67,49,40,63,53,45,55,32,36,54,62,51,54,36,70,35,66,51,30,46,42,45,41,43,50,66,38,69,52,41,53,50,32,70,34,36,40,31,69,50,38,64,70,45,66,32,48,48,37,65,56,43,48,35,62,43,55,29,37,65,44,47,45,42,38,30,59,39,42,66,56,60,70,57,62,66,55,63,67,54,58,62,50,57,38,76,74,52,69,74,75,52,72,60,47,41,72,50,42,53,50,66,49,57,42,46,44,35,65,41,39,60,46,47,75,36,69,54,66,36,44,48,37,42,45,53,62,50,54,48,38,42,42,71,58,59,45,69,61,66,44,57,40,45,47,70,55,70,63,55,57,65,47,55,58,52,29,67,38,39,70,65,60,59,50,50,53,43,52,56,35,63,46,34,62,59,47,44,43,51,64,66,67,39,68,53,64,56,46,58,31,55,33,26,46,43,60,37,50,70,45,49,36,55,46,42,50,39,48,53,37,50,44,54,57,49,73,69,34,62,63,70,46,37,52,53,52,36,37,64,50,46,39,33,32,36,53,47,72,43,67,76,71,57,38,34,50,53,67,50,35,62,41,61,51,50,54,58,53,31,40,45,56,44,49,65,78,62,44,52,51,64,56,47,74,39,53,70,46,65,72,62,48,37,71,44,37,45,70,39,47,53,67,81,45,70,45,57,71,45,65,31,71,56,59,43,69,55,74,49,58,72,43,55,38,50,46,50,52,58,53,42,37,37,47,70,59,46,64,43,30,35,65,58,50,74,63,61,41,46,46,48,41,51,54,51,55,49,44,51,57,62,55,63,35,44,40,63,46,38,54,70,49,43,39,65,69,56,42,56,68,72,36,74,66,45,46,37,71,44,70,37,39,30,51,40,42,50,51,62,48,51,74,70,46,62,66,68,56,48,45,71,52,52,40,39,43,47,70,73,69,37,42,72,65,52,34,38,51,44,61,50,67,48,66,61,33,78,52,29,62,41,50,47,52,45,28,72,71,46,65,45,46,45,72,37,47,49,35,59,51,72,60,66,40,68,47,67,52,40,69,59,50,45,45,41,65,64,49,55,35,56,47,45,45,72,41,64,56,52,51,67,55,47,50,53,64,48,64,50,61,48,59,63,49,45,52,45,38,57,46,66,56,57,41,64,72,29,47,67,31,37,40,56,51,46,70,66,46,54,48,50,66,47,49,57,43,64,61,49,65,64,49,38,50,74,64,64,69,47,48,67,46,31,52,48,43,31,53,41,67,58,58,66,40,71,26,45,67,38,73,43,36,42,39,42,58,51,53,42,59,43,49,37,51,35,44,47,54,75,40,65,67],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171","1172","1173","1174","1175","1176","1177","1178","1179","1180","1181","1182","1183","1184","1185","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1196","1197","1198","1199","1200","1201","1202","1203","1204","1205","1206","1207","1208","1209","1210","1211","1212","1213","1214","1215","1216","1217","1218","1219","1220","1221","1222","1223","1224","1225","1226","1227","1228","1229","1230","1231","1232","1233","1234","1235","1236","1237","1238","1239","1240","1241","1242","1243","1244","1245","1246","1247","1248","1249","1250","1251","1252","1253","1254","1255","1256","1257","1258","1259","1260","1261","1262","1263","1264","1265","1266","1267","1268","1269","1270","1271","1272","1273","1274","1275","1276","1277","1278","1279","1280","1281","1282","1283","1284","1285","1286","1287","1288","1289","1290","1291","1292","1293","1294","1295","1296","1297","1298","1299","1300","1301","1302","1303","1304","1305","1306","1307","1308","1309","1310","1311","1312","1313","1314","1315","1316","1317","1318","1319","1320","1321","1322","1323","1324","1325","1326","1327","1328","1329","1330","1331","1332","1333","1334","1335","1336","1337","1338","1339","1340","1341","1342","1343","1344","1345","1346","1347","1348","1349","1350","1351","1352","1353","1354","1355","1356","1357","1358","1359","1360","1361","1362","1363","1364","1365","1366","1367","1368","1369","1370","1371","1372","1373","1374","1375","1376","1377","1378","1379","1380","1381","1382","1383","1384","1385","1386","1387","1388","1389","1390","1391","1392","1393","1394","1395","1396","1397","1398","1399","1400","1401","1402","1403","1404","1405","1406","1407","1408","1409","1410","1411","1412","1413","1414","1415","1416","1417","1418","1419","1420","1421","1422","1423","1424","1425","1426","1427","1428","1429","1430","1431","1432","1433","1434","1435","1436","1437","1438","1439","1440","1441","1442","1443","1444","1445","1446","1447","1448","1449","1450","1451","1452","1453","1454","1455","1456","1457","1458","1459","1460","1461","1462","1463","1464","1465","1466","1467","1468","1469","1470","1471","1472","1473","1474","1475","1476","1477","1478","1479","1480","1481","1482","1483","1484","1485","1486","1487","1488","1489","1490","1491","1492","1493","1494","1495","1496","1497","1498","1499","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510","1511","1512","1513","1514","1515","1516","1517","1518","1519","1520","1521","1522","1523","1524","1525","1526","1527","1528","1529","1530","1531","1532","1533","1534","1535","1536","1537","1538","1539","1540","1541","1542","1543","1544","1545","1546","1547","1548","1549","1550","1551","1552","1553","1554","1555","1556","1557","1558","1559","1560","1561","1562","1563","1564","1565","1566","1567","1568","1569","1570","1571","1572","1573","1574","1575","1576","1577","1578","1579","1580","1581","1582","1583","1584","1585","1586","1587","1588","1589","1590","1591","1592","1593","1594","1595","1596","1597","1598","1599","1600","1601","1602","1603","1604","1605","1606","1607","1608","1609","1610","1611","1612","1613","1614","1615","1616","1617","1618","1619","1620","1621","1622","1623","1624","1625","1626","1627","1628","1629","1630","1631","1632","1633","1634","1635","1636","1637","1638","1639","1640","1641","1642","1643","1644","1645","1646","1647","1648","1649","1650","1651","1652","1653","1654","1655","1656","1657","1658","1659","1660","1661","1662","1663","1664","1665","1666","1667","1668","1669","1670","1671","1672","1673","1674","1675","1676","1677","1678","1679","1680","1681","1682","1683","1684","1685","1686","1687","1688","1689","1690","1691","1692","1693","1694","1695","1696","1697","1698","1699","1700","1701","1702","1703","1704","1705","1706","1707","1708","1709","1710","1711","1712","1713","1714","1715","1716","1717","1718","1719","1720","1721","1722","1723","1724","1725","1726","1727","1728","1729","1730","1731","1732","1733","1734","1735","1736","1737","1738","1739","1740","1741","1742","1743","1744","1745","1746","1747","1748","1749","1750","1751","1752","1753","1754","1755","1756","1757","1758","1759","1760","1761","1762","1763","1764","1765","1766","1767","1768","1769","1770","1771","1772","1773","1774","1775","1776","1777","1778","1779","1780","1781","1782","1783","1784","1785","1786","1787","1788","1789","1790","1791","1792","1793","1794","1795","1796","1797","1798","1799","1800","1801","1802","1803","1804","1805","1806","1807","1808","1809","1810","1811","1812","1813","1814","1815","1816","1817","1818","1819","1820","1821","1822","1823","1824","1825","1826","1827","1828","1829","1830","1831","1832","1833","1834","1835","1836","1837","1838","1839","1840","1841","1842","1843","1844","1845","1846","1847","1848","1849","1850","1851","1852","1853","1854","1855","1856","1857","1858","1859","1860","1861","1862","1863","1864","1865","1866","1867","1868","1869","1870","1871","1872","1873","1874","1875","1876","1877","1878","1879","1880","1881","1882","1883","1884","1885","1886","1887","1888","1889","1890","1891","1892","1893","1894","1895","1896","1897","1898","1899","1900","1901","1902","1903","1904","1905","1906","1907","1908","1909","1910","1911","1912","1913","1914","1915","1916","1917","1918","1919","1920","1921","1922","1923","1924","1925","1926","1927","1928","1929","1930","1931","1932","1933","1934","1935","1936","1937","1938","1939","1940","1941","1942","1943","1944","1945","1946","1947","1948","1949","1950","1951","1952","1953","1954","1955","1956","1957","1958","1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","2025","2026","2027","2028","2029","2030","2031","2032","2033","2034","2035","2036","2037","2038","2039","2040","2041","2042","2043","2044","2045","2046","2047","2048","2049","2050","2051","2052","2053","2054","2055","2056","2057","2058","2059","2060","2061","2062","2063","2064","2065","2066","2067","2068","2069","2070","2071","2072","2073","2074","2075","2076","2077","2078","2079","2080","2081","2082","2083","2084","2085","2086","2087","2088","2089","2090","2091","2092","2093","2094","2095","2096","2097","2098","2099","2100","2101","2102","2103","2104","2105","2106","2107","2108","2109","2110","2111","2112","2113","2114","2115","2116","2117","2118","2119","2120","2121","2122","2123","2124","2125","2126","2127","2128","2129","2130","2131","2132","2133","2134","2135","2136","2137","2138","2139","2140","2141","2142","2143","2144","2145","2146","2147","2148","2149","2150","2151","2152","2153","2154","2155","2156","2157","2158","2159","2160","2161","2162","2163","2164","2165","2166","2167","2168","2169","2170","2171","2172","2173","2174","2175","2176","2177","2178","2179","2180","2181","2182","2183","2184","2185","2186","2187","2188","2189","2190","2191","2192","2193","2194","2195","2196","2197","2198","2199","2200","2201","2202","2203","2204","2205","2206","2207","2208","2209","2210","2211","2212","2213","2214","2215","2216","2217","2218","2219","2220","2221","2222","2223","2224","2225","2226","2227","2228","2229","2230","2231","2232"],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="calculamos-las-distancias" class="level1">
<h1>Calculamos las distancias</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>distancias<span class="ot">=</span> <span class="fu">daisy</span>(data, </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric=</span><span class="st">"gower"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determinamos-el-número-de-clusters" class="level1">
<h1>Determinamos el número de clusters</h1>
<section id="método-del-codo-elbow-method" class="level2">
<h2 class="anchored" data-anchor-id="método-del-codo-elbow-method">Método del codo (elbow method)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(data, </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>             hcut,                    </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">diss=</span>distancias,        </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"wss"</span>,         </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">k.max =</span> <span class="dv">10</span>,            </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">verbose =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Escogemos <strong>3 clusters</strong></li>
</ul>
</section>
<section id="método-nbclust" class="level2">
<h2 class="anchored" data-anchor-id="método-nbclust">Método NbClust</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>res.nbclust <span class="ot">&lt;-</span> <span class="fu">NbClust</span>(data,           </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">distance =</span> <span class="st">"euclidean"</span>,  </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">min.nc =</span> <span class="dv">2</span>,              </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">max.nc =</span> <span class="dv">5</span>,              </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"average"</span>,      </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span><span class="st">"all"</span>)          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The Hubert index is a graphical method of determining the number of clusters.
                In the plot of Hubert index, we seek a significant knee that corresponds to a 
                significant increase of the value of the measure i.e the significant peak in Hubert
                index second differences plot. 
 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The D index is a graphical method of determining the number of clusters. 
                In the plot of D index, we seek a significant knee (the significant peak in Dindex
                second differences plot) that corresponds to a significant increase of the value of
                the measure. 
 
******************************************************************* 
* Among all indices:                                                
* 6 proposed 2 as the best number of clusters 
* 10 proposed 3 as the best number of clusters 
* 7 proposed 4 as the best number of clusters 
* 1 proposed 5 as the best number of clusters 

                   ***** Conclusion *****                            
 
* According to the majority rule, the best number of clusters is  3 
 
 
******************************************************************* </code></pre>
</div>
</div>
<ul>
<li>Confirmamos que tenemos que usar <strong>3 clusters</strong></li>
</ul>
</section>
</section>
<section id="calculamos-el-cluster" class="level1">
<h1>Calculamos el cluster</h1>
<section id="jerarquico-aglomerativo" class="level2">
<h2 class="anchored" data-anchor-id="jerarquico-aglomerativo">Jerarquico Aglomerativo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>aglomerativo <span class="ot">=</span> <span class="fu">hcut</span>(<span class="at">x =</span> distancias,       </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">k =</span> <span class="dv">3</span>,               </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hc_func=</span><span class="st">'agnes'</span>,      </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">hc_method =</span> <span class="st">"ward.D"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dendograma-de-cluster-jerarquico-aglomerativo" class="level3">
<h3 class="anchored" data-anchor-id="dendograma-de-cluster-jerarquico-aglomerativo">Dendograma de Cluster Jerarquico Aglomerativo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(aglomerativo, </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">rect =</span> <span class="cn">TRUE</span>,  </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.5</span>)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.
ℹ The deprecated feature was likely used in the factoextra package.
  Please report the issue at &lt;https://github.com/kassambara/factoextra/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
ℹ The deprecated feature was likely used in the factoextra package.
  Please report the issue at &lt;https://github.com/kassambara/factoextra/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
of ggplot2 3.3.4.
ℹ The deprecated feature was likely used in the factoextra package.
  Please report the issue at &lt;https://github.com/kassambara/factoextra/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aglomerativo=</span>aglomerativo<span class="sc">$</span>cluster) </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>data2 <span class="sc">%&gt;%</span> </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(aglomerativo) <span class="sc">%&gt;%</span> </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Gasto_total =</span> <span class="fu">mean</span>(Gasto_total),</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Edad =</span> <span class="fu">mean</span>(Edad), </span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">Cantidad_compra_total =</span> <span class="fu">mean</span>(Cantidad_compra_total))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  aglomerativo Gasto_total  Edad Cantidad_compra_total
         &lt;int&gt;       &lt;dbl&gt; &lt;dbl&gt;                 &lt;dbl&gt;
1            1      1356.   51.8                 23.0 
2            2        89.7  48.9                  7.54
3            3       627.   57.7                 17.9 </code></pre>
</div>
</div>
<p>Podemos ver que:</p>
<ul>
<li><p>Cluster 1: Presenta, en promedio, los mayores niveles de gasto total ($1,355.83), la mayor cantidad de compras (23.01) y una edad moderada (51.81 años). Son clientes de alto valor con comportamiento de compra muy activo.</p></li>
<li><p>Cluster 2: Presenta, en promedio, los menores niveles de gasto total ($89.71), la menor cantidad de compras (7.54) y una edad similar a los otros grupos (48.93 años). Son clientes de bajo valor con comportamiento de compra muy limitado.</p></li>
<li><p>Cluster 3: Presenta, en promedio, niveles intermedios de gasto total ($626.83) y cantidad de compras (17.94), pero destaca por tener la mayor edad promedio (57.71 años). Son clientes de valor moderado con comportamiento de compra regular y perfil más maduro.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="at">object =</span> <span class="fu">list</span>(<span class="at">data=</span>data2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cluster =</span> data2<span class="sc">$</span>aglomerativo),</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"text"</span>), </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="validacion-del-cluster" class="level3">
<h3 class="anchored" data-anchor-id="validacion-del-cluster">Validacion del cluster</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>plot_con <span class="ot">&lt;-</span> <span class="fu">fviz_silhouette</span>(aglomerativo, <span class="at">label=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster size ave.sil.width
1       1  648          0.16
2       2  982          0.52
3       3  602          0.27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>plot_con</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El ancho promedio de silueta de 0.35 indica una calidad de clustering moderada y aceptable. El Cluster 2 (verde) es el más compacto y bien definido con excelente cohesión, mientras que el Cluster 1 (rojo) presenta baja cohesión con elementos mal clasificados y el Cluster 3 (azul) muestra cohesión moderada con cierta dispersión. En general, el clustering es satisfactorio, aunque los Clusters 1 y 3 presentan debilidades que podrían mejorarse.</p>
</section>
</section>
<section id="divisivo" class="level2">
<h2 class="anchored" data-anchor-id="divisivo">Divisivo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>divisivo <span class="ot">=</span> <span class="fu">hcut</span>(distancias, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">k =</span> <span class="dv">3</span>,           </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">hc_func=</span><span class="st">'diana'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dendograma-de-divisivo" class="level3">
<h3 class="anchored" data-anchor-id="dendograma-de-divisivo">Dendograma de Divisivo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(divisivo, </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">rect =</span> <span class="cn">TRUE</span>, </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>data3<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">divisivo=</span>divisivo<span class="sc">$</span>cluster) </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>data3 <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(divisivo) <span class="sc">%&gt;%</span> </span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Gasto_total =</span> <span class="fu">mean</span>(Gasto_total),</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Edad =</span> <span class="fu">mean</span>(Edad), </span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">Cantidad_compra_total =</span> <span class="fu">mean</span>(Cantidad_compra_total))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  divisivo Gasto_total  Edad Cantidad_compra_total
     &lt;int&gt;       &lt;dbl&gt; &lt;dbl&gt;                 &lt;dbl&gt;
1        1       1095.  64.4                 21.6 
2        2        147.  50.2                  9.19
3        3       1238.  44.3                 22.0 </code></pre>
</div>
</div>
<p>Podemos ver que:</p>
<ul>
<li><p>Cluster 1 (Divisivo): Presenta, en promedio, altos niveles de gasto total ($1,094.53), la mayor edad promedio (64.45 años) y alto número de compras (21.60). Son clientes de valor alto con perfil maduro.</p></li>
<li><p>Cluster 2 (Divisivo): Presenta, en promedio, los menores niveles de gasto total ($146.84), la menor edad promedio (50.18 años) y el menor número de compras (9.19). Son clientes de bajo valor con comportamiento ocasional.</p></li>
<li><p>Cluster 3 (Divisivo): Presenta, en promedio, el mayor gasto total ($1,238.08), la menor edad promedio (44.34 años) y el mayor número de compras (22.03). Son clientes de valor muy alto, más jóvenes y con comportamiento de compra muy activo.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="at">object =</span> <span class="fu">list</span>(<span class="at">data=</span>data3[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cluster =</span> data3<span class="sc">$</span>divisivo),</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"text"</span>), </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="validacion-de-cluster" class="level3">
<h3 class="anchored" data-anchor-id="validacion-de-cluster">Validacion de Cluster</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>plot_div <span class="ot">&lt;-</span> <span class="fu">fviz_silhouette</span>(divisivo, <span class="at">label=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster size ave.sil.width
1       1  507          0.33
2       2 1234          0.50
3       3  491          0.30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>plot_div</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El ancho promedio de silueta de 0.42 indica una calidad de clustering buena. El Cluster 2 (verde) mantiene su excelente cohesión con valores de silueta altos, el Cluster 1 (rojo) muestra mejor definición con valores cercanos al promedio, y el Cluster 3 (azul) presenta cohesión moderada. Sin embargo, el Cluster 2 presenta algunos puntos con valores negativos de silueta, indicando elementos mal clasificados o fronterizos que podrían pertenecer mejor a otros clusters.</p>
</section>
</section>
</section>
<section id="conclusiones" class="level1">
<h1>Conclusiones</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>plot_con</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>plot_div</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clustering-code-R_files/figure-html/unnamed-chunk-58-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El modelo divisivo con ancho de silueta 0.42 tiene mejor desempeño que el modelo jerárquico aglomerativo con 0.35. El clustering divisivo logra una calidad superior con mayor separación entre clusters y menos elementos mal clasificados. Este modelo identifica tres segmentos de clientes claramente diferenciados: el Cluster 3 representa el segmento más valioso con mayor gasto y frecuencia de compra, el Cluster 1 agrupa clientes maduros de alto valor, y el Cluster 2 clientes ocasionales de bajo valor. Esta segmentación permite implementar estrategias de marketing personalizadas: retención y premium para Clusters 1 y 3, y activación para Cluster 2.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>